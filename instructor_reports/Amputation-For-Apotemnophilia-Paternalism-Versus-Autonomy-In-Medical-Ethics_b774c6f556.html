<!doctype html>
<html lang="en" class="dark-mode">
<head>
  <script>
    // Set the correct Bootswatch theme based on theme_mode immediately
    window.themeMode = 'dark-mode';
    if (window.themeMode === 'light-mode') {
      document.write('<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.2/flatly/bootstrap.min.css" id="theme-css">');
    } else {
      document.write('<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.2/darkly/bootstrap.min.css" id="theme-css">');
    }
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Amputation For Apotemnophilia: Paternalism Versus Autonomy In Medical Ethics</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  
<style>
    :root {
      /* Darkened dark mode theme */
      --bg-color: #050505;          /* Near-black background */
      --card-bg: #0e0e1a;           /* Deeper navy card */
      --card-header-bg: #141422;     /* Darker header */
      --text-color: #e4e6eb;
      --muted-text-color: #a9adc1;
      --border-color: #1f1f2d;
      --button-bg: #252538;
      --button-hover-bg: #3a3a59; 
      --primary-color: #8a8aff;
      --input-bg: #252538;
      --message-left-bg: #141422;
      --message-right-bg: #0e0e1a;
    }

    /* Light mode theme variables */
    html.light-mode {
      /* Base colors */
      --bg-color: #f5f7fa;
      --card-bg: #ffffff;
      --card-header-bg: #f0f5fc;
      --text-color: #2c3e50;
      --muted-text-color: #5a6a7e;
      --border-color: #d1d9e6;
      
      /* UI elements - using purple Sway theme colors */
      --button-bg: #eef2f7; /* keeping grey for basic buttons */
      --button-hover-bg: #d9e2ec; /* keeping grey hover for basic buttons */
      --primary-color: #23004D; /* new purple theme color */
      --input-bg: #ffffff;
      
      /* Message colors */
      --message-left-bg: #eef2f7;
      --message-right-bg: #e6f0ff;
    }

    /* Additional light mode specific overrides for purple theme */
    html.light-mode .card {
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    html.light-mode .card:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
    }

    html.light-mode .card-header {
      border-bottom: 1px solid var(--border-color);
    }

    /* Purple theme for headings and section titles */
    html.light-mode .section-title {
      border-bottom: 1px solid #23004D;
      color: #23004D;
    }

    html.light-mode .section-title i {
      color: #23004D;
    }

    html.light-mode .markdown-content h1,
    html.light-mode .markdown-content h2,
    html.light-mode .markdown-content h3,
    html.light-mode .markdown-content h4,
    html.light-mode .markdown-content h5,
    html.light-mode .markdown-content h6 {
      color: #23004D;
    }

    /* Purple theme for icons */
    html.light-mode .fas,
    html.light-mode .far,
    html.light-mode .fab {
      color: #23004D;
    }

    /* Keep header buttons grey */
    html.light-mode .header-actions .back-btn i,
    html.light-mode .header-actions .nav-btn i {
      color: inherit;
    }

    /* Thread items */
    html.light-mode .thread-item {
      background-color: #ffffff;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    }

    html.light-mode .thread-item:hover {
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      border: 2px solid #23004D;
    }

    html.light-mode .thread-item a {
      color: #23004D;
    }

    /* Badges and info elements */
    html.light-mode .badge-info {
      background-color: #e6e0f0;
      color: #23004D;
    }

    html.light-mode .text-info {
      color: #23004D !important;
    }

    /* Buttons with purple theme */
    html.light-mode .btn-primary {
      background-color: #23004D;
      border-color: #23004D;
    }

    html.light-mode .btn-primary:hover {
      background-color: #380080;
      border-color: #380080;
    }

    /* Content elements */
    html.light-mode .markdown-content code,
    html.light-mode .markdown-content pre {
      background-color: #f0f3f8;
      border: 1px solid #e0e5ee;
    }

    html.light-mode .markdown-content blockquote {
      background-color: #f0f3f8;
      border-left: 4px solid #23004D;
    }

    html.light-mode .markdown-content a {
      color: #23004D;
    }

    /* Info boxes and containers */
    html.light-mode .info-box {
      background-color: #f8fafd;
      border: 1px solid var(--border-color);
    }

    /* Topic labels and special text */
    html.light-mode .text-info {
      color: #23004D !important;
    }

    html.light-mode .col-label {
      color: #23004D;
    }

    /* Thread summary section styling */
    html.light-mode .thread-summary strong {
      color: #23004D;
    }

    /* Keep the orange buttons distinct */
    html.light-mode .btn-orange {
      background-color: #ff7200;
      border-color: #ff7200;
    }

    html.light-mode .btn-orange:hover {
      background-color: #e66800;
      border-color: #e66800;
    }

    /* Theme toggle styling */
    html.light-mode .theme-toggle-slider {
      background-color: #d9e2ec;
    }

    html.light-mode .theme-toggle-slider:before {
      background-color: #ffffff;
    }

    html.light-mode input:checked + .theme-toggle-slider {
      background-color: #23004D;
    }

    /* Pagination with purple theme */
    html.light-mode .page-item.active .page-link {
      background-color: #23004D;
      border-color: #23004D;
    }

    html.light-mode .page-link:hover {
      color: #23004D;
    }

    /* Apply theme variables to elements */
    html {
      margin: 0;
      padding: 0;
      border: none;
      outline: none;
    }
    
    body { 
      margin: 0;
      padding: 0;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      transition: background-color 0.3s ease;
      border: none; /* Remove any borders */
      outline: none; /* Remove any outlines */
    }
    .dashboard-container {
      padding: 10px;
      max-width: 100%;
      margin: 0 auto;
      border: none;
      outline: none;
    }
    @media (min-width: 576px) {
      .dashboard-container {
        padding: 15px;
      }
    }
    @media (min-width: 768px) {
      .dashboard-container {
        padding: 25px;
        margin-left: 0;
        margin-right: 0;
      }
    }
    @media (min-width: 1200px) {
      .dashboard-container {
        margin-left: 0;
        margin-right: 0;
      }
    }
    .card {
      background-color: var(--card-bg);
      border: none;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      margin-bottom: 25px;
      transition: background-color 0.3s ease;
    }
    .card:hover {
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    /* No hover effect for section title cards */
    .card.no-hover:hover {
      transform: none;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .card-header {
      font-size: 1.2rem;
      font-weight: 500;
      background-color: var(--card-header-bg);
      border-bottom: 1px solid var(--border-color);
      border-radius: 10px 10px 0 0 !important;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      transition: background-color 0.3s ease;
    }
    @media (min-width: 576px) {
      .card-header {
        font-size: 1.4rem;
        padding: 15px 20px;
      }
    }
    .card-title {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 10px;
      width: 100%;
    }
    
    .card-title .title-text {
      display: flex;
      align-items: center;
    }
    
    .card-title .badge {
      margin-left: 10px;
    }
    
    .generated-title {
      font-size: 1.68rem;
      font-weight: 600;
      margin-top: 5px;
      font-style: italic;
      margin-bottom: 5px;
      color: var(--primary-color) !important;
    }
    
    @media (min-width: 768px) {
      .card-title {
        margin-bottom: 0;
        width: auto;
      }
    }
    .card-body {
      padding: 15px;
      transition: background-color 0.3s ease;
    }
    @media (min-width: 576px) {
      .card-body {
        padding: 20px 25px;
      }
    }
    .section-title {
      padding-left: 15px;
      margin-top: 20px;
      font-size: 1.2rem;
      font-weight: 500;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
      color: var(--primary-color);
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
      flex-wrap: wrap;
      transition: border-color 0.3s ease, color 0.3s ease;
    }
    .section-title i {
      margin-right: 10px;
    }
    .section-title .title-text {
      display: flex;
      align-items: center;
    }
    .section-title .actions {
      margin-left: auto;
      margin-top: 10px;
      width: 100%;
      text-align: right;
    }
    @media (min-width: 768px) {
      .section-title .actions {
        margin-top: 0;
        width: auto;
      }
    }
    .detail-item {
      margin-bottom: 15px;
      padding: 10px 15px;
      background-color: var(--card-header-bg);
      border-radius: 6px;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      transition: background-color 0.3s ease;
    }
    .detail-item strong {
      min-width: 140px;
      color: var(--muted-text-color);
    }
    .list-group-item {
      background-color: var(--card-header-bg);
      color: var(--text-color);
      border: none;
      border-radius: 6px;
      margin-bottom: 8px;
      transition: background-color 0.2s, color 0.3s ease;
    }
    .list-group-item:hover {
      background-color: var(--button-hover-bg);
    }
    .badge {
      font-size: 0.7em;
      padding: 6px 8px;
      border-radius: 50px;
      font-weight: 500;
      margin-left: 10px;
    }
    .badge-available {
      background-color: #28a745;
      color: #fff;
    }
    .badge-active {
      background-color: #007bff;
      color: #fff;
    }
    .badge-completed {
      background-color: #6c757d;
      color: #fff;
    }
    .badge-cancelled {
      background-color: #dc3545;
      color: #fff;
    }
    .back-btn {
      background-color: var(--button-bg);
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      transition: background-color 0.2s, color 0.3s ease;
      color: var(--text-color);
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    @media (min-width: 768px) {
      .back-btn {
        margin-bottom: 0;
      }
    }
    .back-btn i {
      margin-right: 8px;
    }
    .back-btn:hover {
      background-color: var(--button-hover-bg);
      color: var(--text-color);
      text-decoration: none;
    }
    .header-actions {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      justify-content: flex-end;
      width: 100%;
    }
    @media (min-width: 768px) {
      .header-actions {
        width: auto;
      }
    }
    .refresh-button {
      margin-right: 16px;
      display: flex;
      align-items: center;
    }
    .icon-btn {
      background: none;
      border: none;
      color: #8a8aff;
      font-size: 1.2rem;
      cursor: pointer;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s ease;
    }
    .icon-btn:hover {
      background-color: rgba(138, 138, 255, 0.1);
    }
    .icon-btn:focus {
      outline: none;
    }
    .icon-btn:active {
      transform: scale(0.9);
    }
    .info-box {
      padding: 15px;
      background-color: var(--card-header-bg);
      border-radius: 8px;
      margin-bottom: 20px;
      transition: background-color 0.3s ease;
    }
    .col-label {
      color: var(--muted-text-color);
      font-weight: 500;
      transition: color 0.3s ease;
    }
    .col-value {
      font-weight: 400;
    }
    .utc-time {
      opacity: 0;
      transition: opacity 0.3s;
    }
    .local-time {
      opacity: 1;
    }
    /* New Chat Threads Section Styling */
    .thread-list {
      margin-top: 15px;
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      gap: 15px;
    }
    @media (min-width: 768px) {
      .thread-list {
        flex-wrap: nowrap;
      }
      .thread-list-column {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 15px;
        width: calc(50% - 8px);
      }
    }
    .thread-card {
      margin-bottom: 0 !important;
    }
    .thread-item {
      display: flex;
      flex-direction: column;
      width: 100%;
      opacity: 1; /* Ensure visibility */
      padding: 15px;
      background-color: var(--card-bg);
      border-radius: 12px;
      transition: background-color 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      border: 2px solid transparent;
    }
    .thread-item:hover {
      background-color: var(--card-bg);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      border: 2px solid transparent; /* Remove orange border */
    }
    .thread-item.visible {
      opacity: 1;
    }
    .thread-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .thread-header .thread-actions {
      display: flex;
      gap: 6px;
      white-space: nowrap;
    }
    .thread-item a {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      display: inline-block;
      margin-bottom: 5px;
      transition: color 0.3s ease;
    }
    .thread-item a:hover {
      text-decoration: underline;
    }
    .thread-summary {
      font-size: 0.9em;
      color: var(--muted-text-color);
      margin-top: 5px;
      margin-left: 10px;
      line-height: 1.5;
      transition: color 0.3s ease;
    }
    .thread-summary p {
      margin-bottom: 0.5em;
    }
    .thread-summary ul,
    .thread-summary ol {
      margin-top: 0.5em;
      margin-bottom: 0.5em;
      padding-left: 1.5em;
    }
    .thread-summary li {
      margin-bottom: 0.3em;
    }
    .thread-summary a {
      color: var(--primary-color);
    }
    .thread-summary code {
      background-color: var(--card-header-bg);
      border-radius: 3px;
      padding: 2px 5px;
      font-family: monospace;
      transition: background-color 0.3s ease;
    }
    .thread-status {
      font-size: 0.8em;
      margin-top: 3px;
      margin-left: 10px;
    }
    /* Markdown content styling */
    .markdown-content {
      line-height: 1.6;
      overflow-wrap: break-word;
      word-wrap: break-word;
    }
    .markdown-content h1,
    .markdown-content h2,
    .markdown-content h3,
    .markdown-content h4,
    .markdown-content h5,
    .markdown-content h6 {
      margin-top: 1.5em;
      margin-bottom: 0.75em;
      color: var(--primary-color);
      font-weight: 500;
      transition: color 0.3s ease;
    }
    .markdown-content h1 {
      font-size: 1.7em;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.3em;
      transition: border-color 0.3s ease;
    }
    .markdown-content h2 {
      font-size: 1.5em;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.3em;
      transition: border-color 0.3s ease;
    }
    .markdown-content h3 {
      font-size: 1.3em;
    }
    .markdown-content h4 {
      font-size: 1.1em;
    }
    .markdown-content p {
      margin-bottom: 1em;
    }
    .markdown-content ul, 
    .markdown-content ol {
      margin-bottom: 1em;
      padding-left: 2em;
    }
    .markdown-content li {
      margin-bottom: 0.5em;
    }
    /* Proper nested list styling */
    .markdown-content ul ul,
    .markdown-content ul ol,
    .markdown-content ol ul,
    .markdown-content ol ol {
      margin-top: 0.5em;
      margin-bottom: 0.5em;
    }
    .markdown-content li > ul,
    .markdown-content li > ol {
      margin-left: 1em;
    }
    .markdown-content blockquote {
      padding: 0.5em 1em;
      margin-left: 0;
      margin-right: 0;
      background-color: var(--card-header-bg);
      border-left: 4px solid var(--primary-color);
      margin-bottom: 1em;
      transition: background-color 0.3s ease, border-left-color 0.3s ease;
    }
    .markdown-content code {
      background-color: var(--card-header-bg);
      border-radius: 3px;
      padding: 2px 5px;
      font-family: monospace;
      transition: background-color 0.3s ease;
    }
    .markdown-content pre {
      background-color: var(--card-header-bg);
      border-radius: 5px;
      padding: 1em;
      overflow-x: auto;
      margin-bottom: 1em;
      transition: background-color 0.3s ease;
    }
    .markdown-content table {
      border-collapse: collapse;
      margin-bottom: 1em;
      width: 100%;
    }
    .markdown-content table th,
    .markdown-content table td {
      border: 1px solid var(--border-color);
      padding: 0.5em;
      transition: border-color 0.3s ease;
    }
    .markdown-content table th {
      background-color: var(--card-header-bg);
      text-align: left;
      transition: background-color 0.3s ease;
    }
    .markdown-content strong {
      font-weight: 600;
      color: var(--text-color);
      transition: color 0.3s ease;
    }
    .markdown-content em {
      font-style: italic;
    }
    /* Mobile-specific styles */
    @media (max-width: 767.98px) {
      .row:not(.mb-3) {
        margin-right: -5px;
        margin-left: -5px;
      }
      .row:not(.mb-3) > .col, 
      .row:not(.mb-3) > [class*="col-"] {
        padding-right: 5px;
        padding-left: 5px;
      }
      .btn {
        padding: 0.375rem 0.5rem;
      }
      .btn-orange {
        width: 100%;
        margin-bottom: 10px;
      }
      #report-btn, #generate-btn, #cancel-btn {
        width: 100%;
      }
      /* Hide theme toggle and edit prompts in mobile */
      .theme-toggle {
        display: none !important;
      }
      a.back-btn[href*="edit_prompts"] {
        display: none !important;
      }
      #share-export-btn {
        margin-right: 0 !important;
      }
    }
    /* End markdown styling */

    /* Limit Topics container height to match the Info card */
    #topics-container {
      max-height: 420px;
      min-height: 420px;
      overflow-y: auto;
    }
    /* Smaller height for export mode */
    html.export-mode #topics-container {
      max-height: 345px;
      min-height: 345px;
    }

    /* New Opinion Histograms styling */
    .histogram-container {
      background-color: #090118 !important;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }
    .histogram-container:hover {
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    .histogram-container img {
      max-width: 100%;
      border-radius: 6px;
      display: block;
      margin: 0 auto;
    }
    
    .histogram-bar {
      background: linear-gradient(180deg, #a9a9ff 0%, #8a8aff 100%);
      border-radius: 4px 4px 6px 6px;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      box-shadow: 0 2px 6px rgba(138,138,255,0.2);
    }
    .histogram-bar:hover {
      box-shadow: 0 4px 8px rgba(138,138,255,0.4);
    }
    .histogram-axis-line {
      background: rgba(169,173,193,0.4);
      width: 2px;
    }
    .histogram-grid-line {
      background: rgba(169,173,193,0.13);
      height: 1px;
    }
    .histogram-container .axis-label {
      color: #a9adc1;
      font-size: 0.95rem;
      opacity: 0.85;
    }
    .histogram-container .x-label {
      color: #a9adc1;
      font-size: 1.1rem;
      font-weight: 500;
      margin-top: 0.35rem;
    }
    .histogram-container .card-body {
      padding: 1.25rem;
    }
    
    @media (max-width: 767.98px) {
      .col-md-6.col-lg-4.mb-4 {
        padding-left: 10px;
        padding-right: 10px;
      }
      .histogram-container {
        padding: 10px;
      }
    }

    /* Theme toggle switch styling */
    .theme-toggle {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-right: 10px;
      margin-bottom: 10px;
    }
    
    .theme-toggle-switch {
      position: relative;
      display: inline-block;
      width: 52px;
      height: 26px;
    }
    
    .theme-toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .theme-toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #2d2d43;
      transition: .4s;
      border-radius: 34px;
    }
    
    .theme-toggle-slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .theme-toggle-slider {
      background-color: #4a4a69;
    }
    
    input:checked + .theme-toggle-slider:before {
      transform: translateX(26px);
    }
    
    .theme-toggle-icon {
      color: var(--text-color);
      font-size: 16px;
    }

    /* Add social sharing buttons styling */
    .social-share-container {
      background-color: var(--card-header-bg);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      text-align: center;
    }
    .social-share-title {
      font-size: 1.1rem;
      margin-bottom: 12px;
      color: var(--primary-color);
    }
    .social-share-buttons {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 8px;
    }
    .social-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 12px;
      border-radius: 5px;
      color: white;
      font-weight: 500;
      text-decoration: none;
      transition: opacity 0.2s;
      font-size: 0.9rem;
    }
    .social-btn:hover {
      opacity: 0.85;
      text-decoration: none;
      color: white;
    }
    .social-btn i {
      margin-right: 6px;
      font-size: 0.9rem;
    }
    .btn-twitter {
      background-color: #1DA1F2;
    }
    .btn-facebook {
      background-color: #4267B2;
    }
    .btn-linkedin {
      background-color: #0077B5;
    }
    .btn-instagram {
      background: linear-gradient(45deg, #405DE6, #5851DB, #833AB4, #C13584, #E1306C, #FD1D1D);
    }
    @media (max-width: 576px) {
      .social-btn {
        padding: 4px 9px;
        font-size: 0.8rem;
      }
      .social-btn i {
        margin-right: 4px;
      }
    }

    .full-width-page {
      width: 100%;
      max-width: 1420px;
      margin: 0 auto;
      padding-left: 24px;
      padding-right: 24px;
    }
    @media (min-width: 576px) {
      .full-width-page {
        padding-left: 50px;
        padding-right: 50px;
      }
    }
    @media (min-width: 992px) {
      .full-width-page {
        padding-left: 64px;
        padding-right: 64px;
      }
    }

    /* Histogram card styling - more aggressive fixes */
    .histogram-card {
      background-color: #070113 !important;
      border: none; 
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      margin-bottom: 0;
      overflow: hidden;
    }

    .histogram-card:hover {
      box-shadow: 0 7px 15px rgba(0,0,0,0.25);
    }

    .histogram-card .card-body {
      padding: 8px 0 !important;
    }

    /* Target histogram SVG elements directly */
    .histogram-card svg {
      max-width: 100% !important;
      margin-left: -20px !important; /* Pull SVG to the left */
      width: calc(100% + 20px) !important; /* Compensate for negative margin */
    }

    /* More aggressive targeting for histogram titles */
    .histogram-card h3,
    .histogram-card .x-label,
    .histogram-card text.title,
    .histogram-card [class*="title"],
    .histogram-card text[font-size="14px"],
    .histogram-card text[font-weight="bold"] {
      text-transform: capitalize !important;
      font-size: 1.15rem !important;
      font-weight: 600 !important;
      color: var(--primary-color) !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
      max-width: 95% !important;
      display: block !important;
    }

    /* Add text truncation to histogram title element specifically */
    .histogram-card .histogram-content svg text[y="30"],
    .histogram-card .histogram-content svg text.title {
      text-overflow: ellipsis !important;
      white-space: nowrap !important;
      overflow: hidden !important;
      max-width: 250px !important;
    }

    /* Target mean text specifically */
    .histogram-card .mean-text,
    .histogram-card text[y="300"],
    .histogram-card text:last-of-type,
    .histogram-card text[font-size="12px"] {
      font-size: 0.9rem !important;
    }

    /* Add italicized m= to mean values with several selectors to catch them */
    .histogram-card .mean-text::before,
    .histogram-card text[y="300"]::before,
    .histogram-card text:last-of-type::before {
      content: "m = ";
      font-style: italic;
    }

    @media (max-width: 767.98px) {
      .histogram-card .card-body {
        padding: 8px 0 !important;
      }
    }

    /* Card with no hover effects */
    .no-hover {
      transition: background-color 0.3s ease !important;
    }

    .no-hover:hover {
      transform: none !important;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2) !important;
    }

    .thread-heading {
      color: var(--primary-color) !important;
      font-weight: 600;
    }

    /* Truncate long histogram HTML titles with ellipsis */
    .histogram-title,
    .histogram-card [style*="font-size:1.25rem"] {
      font-size: 1rem !important;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display: block;
      max-width: 95%;
    }

    /* Hide histogram cards that only contain "No data" text */
    .histogram-card .histogram-content:only-child:has(> div.text-muted:only-child:contains("No data")),
    .card-body .histogram-content:only-child:has(> div.text-muted:only-child:contains("No data")),
    .histogram-content:has(> div.text-muted:only-child:contains("No data")) {
      display: none !important;
    }
    
    /* Also hide the parent cards when they only contain "No data" content */
    .histogram-card:has(.histogram-content:only-child > div.text-muted:only-child:contains("No data")),
    .card-body:has(.histogram-content:only-child > div.text-muted:only-child:contains("No data")) {
      display: none !important;
    }
    
    /* Hide the entire column if it only contains a "No data" card */
    .col-md-6:has(.card.histogram-card:only-child:has(.histogram-content > div.text-muted:only-child:contains("No data"))),
    .col-lg-4:has(.card.histogram-card:only-child:has(.histogram-content > div.text-muted:only-child:contains("No data"))) {
      display: none !important;
    }

    /* Bootstrap Histogram Styles */
    .histogram-container {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        width: 100%;
        height: 100%;
        position: relative;
    }
    
    .histogram-bar-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100%;
        padding: 0 2px;
    }
    
    .histogram-bar {
        width: 80%;
        transition: background-color 0.2s ease;
        border-radius: 3px 3px 0 0;
    }
    
    .histogram-bar:hover {
        background-color: #a5a5ff !important;
    }
    
    .histogram-label {
        margin-top: 5px;
        font-size: 11px;
        text-align: center;
    }
    
    .histogram-stats {
        margin-top: 10px;
        text-align: center;
    }
    
    /* Light mode overrides for histograms */
    html.light-mode .histogram-bar {
        background-color: #6a6ae6 !important;
    }
    
    html.light-mode .histogram-bar:hover {
        background-color: #8a8aff !important;
    }

    /* Histogram Checkbox Styles */
    .histogram-export-checkbox {
        position: absolute;
        bottom: 8px;
        right: 8px;
        z-index: 2;
        opacity: 0.6;
        transform: translateY(0);
        transition: opacity 0.2s ease, transform 0.2s ease;
    }
    
    .histogram-export-checkbox:hover {
        opacity: 1;
        transform: translateY(-2px);
    }
    
    .histogram-export-checkbox input[type="checkbox"] {
        margin-right: 4px;
        cursor: pointer;
        accent-color: var(--card-bg); /* Match card background for subtlety */
        opacity: 0.5;
        transition: opacity 0.2s;
    }
    
    .histogram-export-checkbox input[type="checkbox"]:hover,
    .histogram-export-checkbox input[type="checkbox"]:focus {
        opacity: 0.85;
    }
    
    .histogram-export-checkbox label {
        font-size: 0.75rem;
        cursor: pointer;
        margin: 0;
        color: var(--muted-text-color);
    }
    
    /* Make the card position relative so absolute positioned checkbox works */
    .card.thread-card .card-body {
        position: relative;
    }
    
    /* Highlight the checkbox when checked */
    .histogram-export-checkbox input[type="checkbox"]:checked + label {
        color: var(--primary-color);
        font-weight: 500;
    }

    .card.thread-card .card-header {
      background-color: #070113 !important;
    }
</style>
  <style>
    /* Global color fixes */
    body, html {
      min-height: 100vh;
      width: 100%;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      background-color: #000000; /* Default to black for dark mode */
    }
    
    /* Override for light mode */
    html.light-mode, 
    body.light-mode {
      background-color: white;
    }
    
    /* Ensure all content containers have proper width */
    .container, 
    .container-fluid, 
    .row {
      max-width: 100%;
    }
    
    /* Eliminate any unwanted margins on containers */
    .row {
      margin-left: 0;
      margin-right: 0;
    }
    
    .full-width-page {
      width: 100%;
      max-width: 100vw;
      overflow-x: hidden;
      box-sizing: border-box;
    }
    
    /* Apple-inspired font styling */
    body, button, input, select, textarea {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display", "Helvetica Neue", Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    h1, h2, h3, h4, h5, h6, .section-title, .generated-title {
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-weight: 600;
      letter-spacing: +0.005em;
    }
    
    /* Custom styles for floating thread items */
    .card.no-hover:hover {
      transform: none;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }
    
    .thread-list {
      margin-top: 15px;
      position: relative;
      display: block;
      clear: both;
      margin-bottom: 10px;
    }
    
    /* Masonry layout using columns */
    .masonry-grid {
      column-count: 2;
      column-gap: 1.5rem;
      width: 100%;
      margin-bottom: 8px;
    }
    
    @media (max-width: 767px) {
      .masonry-grid {
        column-count: 1;
      }
    }
    
    .masonry-item {
      break-inside: avoid;
      margin-bottom: 1.5rem;
      display: block;
    }
    
    /* Items in the masonry grid */
    .masonry-grid .masonry-item {
      break-inside: avoid;
      margin-bottom: 1.5rem;
      display: block;
    }
    
    /* Make sure thread cards in masonry layout have required styles */
    .masonry-grid .card.thread-card, .card.thread-card {
      background: none !important;
      border: 1px solid var(--thread-card-border, #313131) !important;
      border-radius: 12px !important;
      box-shadow: none !important;
      transition: border-color 0.2s;
    }
    
    /* Dark mode border override */
    body.dark-mode .masonry-grid .card.thread-card,
    body.dark-mode .card.thread-card {
      border-color: #23263a !important;
    }
    
    /* Override any position:relative that may be applied to .card-body elsewhere */
    .masonry-grid .card.thread-card .card-body {
      position: static;
    }
    
    .masonry-grid .card.thread-card:hover {
      box-shadow: 0 6px 20px rgba(0,0,0,0.25);
    }
    
    .masonry-item.hidden-thread {
      visibility: hidden !important;
      opacity: 0 !important;
      height: 0 !important;
      padding-top: 0 !important;
      padding-bottom: 0 !important;
      margin-top: 0 !important;
      margin-bottom: 0 !important;
      border-top-width: 0 !important;
      border-bottom-width: 0 !important;
      overflow: hidden !important;
      pointer-events: none !important;
    }
    
    .show-toggle-btn {
      display: block;
      margin: 30px auto 10px auto;
      min-width: 220px;
      font-weight: 500;
      transition: background 0.2s, color 0.2s;
    }
    .show-toggle-btn i {
      margin-left: 8px;
      transition: transform 0.2s;
    }
    .show-toggle-btn.expanded i {
      transform: rotate(180deg);
    }
    .collapsible-section {
      transition: max-height 0.4s cubic-bezier(0.4,0,0.2,1), opacity 0.4s;
      overflow: hidden;
      opacity: 1;
      max-height: 2000px; /* Large enough for most content */
    }
    .collapsible-section.collapsed {
      max-height: 0 !important;
      opacity: 0;
      pointer-events: none;
    }
    /* Premium title styling with maximum specificity to override any other styles */
    html body .generated-title,
    html[class] body .generated-title,
    body .generated-title.text-info,
    .full-width-page .generated-title,
    .generated-title {
      font-size: 2.5rem !important;
      line-height: 1.2 !important;
      margin-top: 2.5rem !important;
      margin-bottom: 1rem !important;
      font-weight: 600;
      color: white !important;
      text-shadow: 0 1px 3px rgba(0,0,0,0.15);
      letter-spacing: -0.0025em;
      display: block;
      position: relative;
      max-width: 94%;
      padding-bottom: 0.5rem;
      font-style: normal !important; /* Force normal style, no italics */
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", Helvetica, Arial, sans-serif !important;
    }
    
    .generated-title::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      width: 8rem;
      height: 3px;
      background: white;
      opacity: 0.7;
      border-radius: 2px;
    }
    
    /* Enhanced styling for better title visibility */
    .dark-mode .generated-title {
      text-shadow: 0 2px 4px rgba(0,0,0,0.3), 0 0 10px rgba(0,0,0,0.1);
    }
    
    /* Light mode title styling */
    .light-mode .generated-title {
      color: #4750c5 !important;
      text-shadow: none;
    }
    
    /* Adjust underline color in light mode */
    .light-mode .generated-title::after {
      background: #4750c5;
      opacity: 0.5;
    }
    
    /* Fix for pure black background in dark mode - only targeting page containers */
    body.dark-mode,
    html.dark-mode,
    .dark-mode .full-width-page {
      background-color: #000000 !important;
    }
    
    /* Explicitly exempt chart elements from background override */
    .dark-mode .progress,
    .dark-mode .progress-bar,
    .dark-mode .bg-success,
    .dark-mode .bg-info,
    .dark-mode .bg-warning,
    .dark-mode .bg-danger,
    .dark-mode .bg-secondary,
    .dark-mode .chart-container,
    .dark-mode [class*="histogram-"] {
      background-color: initial !important; /* Preserve original background colors */
    }
    
    /* Ensure the page fills the viewport */
    html, body {
      min-height: 100% !important;
      height: 100% !important;
    }
    
    .dark-mode.shared-page {
      background-color: #000000 !important;
    }
    
    /* For longer titles, ensure they wrap properly */
    @media (max-width: 992px) {
      .generated-title {
        font-size: 2.4rem !important;
        max-width: 100%;
      }
    }
    
    @media (max-width: 576px) {
      .generated-title {
        font-size: 2rem !important;
        margin-top: 2rem !important;
        margin-bottom: 1.2rem !important;
      }
    }
    .section-title {
      font-size: 1.7rem !important;
      font-weight: 600;
      margin-bottom: 1.2rem;
      letter-spacing: -0.01em;
    }
    /* Remove background from thread card headers */
    .card.thread-card .card-header {
      background: none !important;
      border-bottom: none !important;
    }
    .small {
      font-size: 1em !important;
    }
    /* Show More/Fewer Threads button custom color */
    .btn-thread-toggle {
      color: #3498DB !important;
      border-color: #3498DB !important;
      background: transparent !important;
    }
    .btn-thread-toggle:hover, .btn-thread-toggle:focus {
      background: #eaf6fb !important;
      color: #217dbb !important;
      border-color: #217dbb !important;
    }
    /* Prevent button flash in dark mode */
    .dark-mode .btn-thread-toggle,
    .dark-mode .btn-thread-toggle:active,
    .dark-mode .btn-thread-toggle:focus,
    .dark-mode .btn-thread-toggle:hover {
      background: transparent !important;
      border-color: #99aaff !important;
      color: #99aaff !important;
      box-shadow: none !important;
    }
    /* Ensure info text under section headings aligns with the heading text */
    .section-info-align {
      margin-left: 2.2rem; /* matches the icon+text indent of .section-title .title-text */
    }
    .hidden-histogram {
      display: none !important;
    }
    /* Add extra margin above Continue Reading button in Instructor Report */
    #report-content + .show-toggle-btn {
      margin-top: 2.5rem !important;
    }
    .collapsible-section + .show-toggle-btn {
      margin-top: 2.5rem !important;
    }

    /* ===== Stylish Share Banner ===== */
    .share-banner {
      margin: 0 -1.5rem 2rem -1.5rem;
      background: rgba(24, 26, 45, 0.95);
      backdrop-filter: blur(10px);
      padding: 1.5rem 0;
      position: relative;
      z-index: 10;
    }
    .light-mode .share-banner {
      background: rgba(46, 87, 170, 0.9);
    }
    .share-container {
      display: flex;
      justify-content: center;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 2rem;
    }
    .share-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 1.2rem;
    }
    .share-text {
      font-size: 1.1rem;
      color: white;
      opacity: 0.95;
      font-weight: 500;
      letter-spacing: -0.01em;
    }
    .share-buttons {
      display: flex;
      gap: 1.2rem;
      justify-content: center;
    }
    .share-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      color: white;
      text-decoration: none;
      transition: all 0.2s ease;
      background: rgba(255, 255, 255, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      transform: translateY(-2px);
    }
    .share-button i {
      font-size: 1.1rem;
    }
    .share-button:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.3);
    }
    .share-button:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: all 0.1s ease;
    }
    .twitter-share {
      background: #000000; /* X logo has a black background */
    }
    .facebook-share {
      background: #4267B2;
    }
    .linkedin-share {
      background: #0077B5;
    }
    .instagram-share {
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
    }
    @media (max-width: 576px) {
      .share-text {
        font-size: 0.95rem;
      }
      .share-button {
        width: 2.6rem;
        height: 2.6rem;
      }
    }
    /* ===== End Share Header Styles ===== */

    /* ===== Additional Layout Adjustments for Share Header ===== */
    .shared-page {
      padding-top: 0 !important;
    }
    
    .shared-page .generated-title {
      margin-top: 3.2rem !important;
      animation: title-fade-in 1s ease-out;
    }
    
    /* Add spacing between share banner and content */
    .share-banner + .row {
      margin-top: 2.5rem;
    }
    
    /* Subtle animation for title appearance */
    @keyframes title-fade-in {
      0% {
        opacity: 0;
        transform: translateY(10px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    /* ===== End Layout Adjustments ===== */

    /* Add improved line spacing for content */
    .markdown-content {
      line-height: 1.6;
    }
    
    .markdown-content p, 
    .markdown-content li,
    .thread-summary p, 
    .thread-summary li {
      line-height: 1.65;
      margin-bottom: 0.9em;
    }
    
    .markdown-content h3, 
    .markdown-content h4 {
      margin-top: 1.7em;
      margin-bottom: 0.7em;
      line-height: 1.4;
    }
    
    /* Improve readability of thread cards */
    .thread-card .card-body,
    .thread-summary {
      line-height: 1.65;
    }
    
    /* Increase spacing between list items */
    .markdown-content ul, 
    .markdown-content ol,
    .thread-summary ul,
    .thread-summary ol {
      padding-left: 1.6em;
      margin-bottom: 1.2em;
    }

    /* Final fixes to ensure proper layout */
    @media (max-width: 767px) {
      body.dark-mode .px-md-3 {
        padding-left: 0.5rem !important;
        padding-right: 0.5rem !important;
      }
    }
  </style>
</head>
<body class="dark-mode" style="background-color: #000000 !important; margin: 0; padding: 0; max-width: 100vw; overflow-x: hidden;">
  <div class="full-width-page shared-page px-md-4 py-4 px-2" style="max-width: 100vw; overflow-x: hidden; background-color: #000000;">
    <div class="content-wrapper" style="max-width: 1400px; margin: 0 auto;">
      
      
      <div class="row mb-5">
        <div class="col-12 px-2 px-md-4">
          <h1 class="generated-title">
            Amputation For Apotemnophilia: Paternalism Versus Autonomy In Medical Ethics
          </h1>
        </div>
      </div>
      <div class="row mb-4">
        <div class="col-md-6 mb-4 mb-md-0">
          <div class="py-4 h-100">
            
<h5 class="section-title">
  <div class="title-text"><i class="fas fa-calendar-alt"></i> Timelines</div>
</h5>

  <div id="timelines-container" class="card-body">
    
      <div class="row mb-2">
        <div class="col-5 col-label">Completion deadline:</div>
        <div class="col-7 col-value">
          <span class="utc-time" data-utc-time="2025-02-13 05:59:00+00:00">2025-02-13 05:59:00+00:00</span>
          <span class="local-time"></span>
        </div>
      </div>
    
      <div class="row mb-2">
        <div class="col-5 col-label">Opinion deadline:</div>
        <div class="col-7 col-value">
          <span class="utc-time" data-utc-time="2025-02-12 05:59:00+00:00">2025-02-12 05:59:00+00:00</span>
          <span class="local-time"></span>
        </div>
      </div>
    
  </div>


<h5 class="section-title mt-4">
  <div class="title-text"><i class="fas fa-info-circle"></i> Info</div>
</h5>
<div id="info-container" class="card-body">
  <div class="row mb-3">
    <div class="col-5 col-label">Instructor:</div>
    <div class="col-7 col-value">[Redacted]</div>
  </div>
  <div class="row mb-3">
    <div class="col-5 col-label">Min. chat time:</div>
    <div class="col-7 col-value">
      
        25 minutes
      
    </div>
  </div>
  <div class="row mb-3">
    <div class="col-5 col-label">Created on:</div>
    <div class="col-7 col-value">
      <span class="utc-time" data-utc-time="2025-02-05 19:09:29.190361+00:00">2025-02-05 19:09:29.190361+00:00</span>
      <span class="local-time"></span>
    </div>
  </div>
  
  
  <div class="row mb-3">
    <div class="col-5 col-label">Chat threads:</div>
    <div class="col-7 col-value">17</div>
  </div>
</div> 
          </div>
        </div>
        <div class="col-md-6">
          <div class="py-4 h-100">
            <!-- Topics Section Partial -->


<h5 class="section-title">
  <div class="title-text"><i class="fas fa-bookmark"></i> Topics</div>
</h5>

  <div id="topics-container" class="card-body">
    
      <div class="mb-3">
        <div class="text-info mb-1 font-weight-bold">Apotemnophilia</div>
        <div>Physicians should use amputation as a treatment for apotemnophilia.</div>
      </div>
      <hr class="my-3" style="border-color: #2d2d43;">
    
      <div class="mb-3">
        <div class="text-info mb-1 font-weight-bold">Medical Paternalism</div>
        <div>Medical paternalism can be justified if the expected gain to patient welfare is sufficiently high.</div>
      </div>
      <hr class="my-3" style="border-color: #2d2d43;">
    
      <div class="mb-3">
        <div class="text-info mb-1 font-weight-bold">Patient Autonomy</div>
        <div>The right to patient autonomy entails that physicians act wrongly if they mislead their patients about or nudge their patients toward any treatment option.</div>
      </div>
      
    
  </div>
 
          </div>
        </div>
      </div>
      <div class="row mb-2">
        <div class="col-12">
          <h5 class="section-title">
            <div class="title-text"><i class="fas fa-chart-bar mr-1"></i> Opinion Distribution</div>
            
          </h5>
        </div>
        <div class="pt-0 pb-2">
          <div class="text-muted small mb-0 section-info-align">
            <i class="fas fa-info-circle mr-1"></i>Opinion scale: 1 = Strongly Disagree, 7 = Strongly Agree. Mean and 95% CI shown below each chart.
          </div>
          <!-- DEBUG: Show if histogram_html or topic_labels are missing -->
          
          
        </div>
      </div>

      <!-- Separate row for histogram charts floating on background -->
      <div class="row mb-4">
        <div class="col-12">
          
            <div class="row" id="opinion-histogram-row">
              
              
                
                  <div class="col-md-6 col-lg-4 mb-4 opinion-histogram-card" data-index="0">
                    <!-- Individual Opinion Histogram Card -->
<div class="card histogram-card">
  <div class="card-body p-0 px-1 position-relative">
    <div class="histogram-content">
      
        <div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:25px;">
            <div style="font-size:1.25rem; font-weight:500; margin-bottom:15px;">Apotemnophilia</div>
            <div style="position:relative; height:175px; width:100%; margin-bottom:10px;">
                <!-- Y-axis -->
                <div style="position:absolute; top:0; left:0; bottom:25px; width:40px; display:flex; flex-direction:column; justify-content:space-between;">
        
                    <div style="position:absolute; top:0.0%; right:10px; color:#a9adc1; font-size:14px;">10</div>
            
                    <div style="position:absolute; top:50.0%; right:10px; color:#a9adc1; font-size:14px;">5</div>
            
                    <div style="position:absolute; top:100.0%; right:10px; color:#a9adc1; font-size:14px;">0</div>
            
                    <div style="position:absolute; top:0; bottom:0; right:0; width:1px; background:rgba(169,173,193,0.3);"></div>
                </div>
                
                <!-- Horizontal grid lines -->
                <div style="position:absolute; top:0; left:40px; right:0; bottom:25px;">
        
                    <div style="position:absolute; top:0.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:50.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:100.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                </div>
                <div style="position:absolute; top:0; left:40px; right:0; bottom:25px; display:flex; align-items:flex-end; justify-content:space-between; padding:0 2px;">
        
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:100.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:80.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:60.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:20.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:40.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:40.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:10.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                </div>
                <div style="position:absolute; left:40px; right:0; bottom:0; height:25px; display:flex; justify-content:space-between; padding:0 2px;">
        
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-3</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-2</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-1</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">0</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">1</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">2</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">3</div>
            
                </div>
            </div>
        
            <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:6px; letter-spacing:0.01em;">
                mean = -1.06 <span style="opacity:0.7;">(95% confidence interval: -1.70–-0.42)</span>
            </div>
            
        </div>
        
    </div>
  </div>
</div> 
                  </div>
                  
                
              
                
                  <div class="col-md-6 col-lg-4 mb-4 opinion-histogram-card" data-index="0">
                    <!-- Individual Opinion Histogram Card -->
<div class="card histogram-card">
  <div class="card-body p-0 px-1 position-relative">
    <div class="histogram-content">
      
        <div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:25px;">
            <div style="font-size:1.25rem; font-weight:500; margin-bottom:15px;">Medical Paternalism</div>
            <div style="position:relative; height:175px; width:100%; margin-bottom:10px;">
                <!-- Y-axis -->
                <div style="position:absolute; top:0; left:0; bottom:25px; width:40px; display:flex; flex-direction:column; justify-content:space-between;">
        
                    <div style="position:absolute; top:0.0%; right:10px; color:#a9adc1; font-size:14px;">15</div>
            
                    <div style="position:absolute; top:33.33333333333333%; right:10px; color:#a9adc1; font-size:14px;">10</div>
            
                    <div style="position:absolute; top:66.66666666666666%; right:10px; color:#a9adc1; font-size:14px;">5</div>
            
                    <div style="position:absolute; top:100.0%; right:10px; color:#a9adc1; font-size:14px;">0</div>
            
                    <div style="position:absolute; top:0; bottom:0; right:0; width:1px; background:rgba(169,173,193,0.3);"></div>
                </div>
                
                <!-- Horizontal grid lines -->
                <div style="position:absolute; top:0; left:40px; right:0; bottom:25px;">
        
                    <div style="position:absolute; top:0.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:33.33333333333333%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:66.66666666666666%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:100.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                </div>
                <div style="position:absolute; top:0; left:40px; right:0; bottom:25px; display:flex; align-items:flex-end; justify-content:space-between; padding:0 2px;">
        
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:0.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:60.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:26.666666666666668%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:20.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:93.33333333333333%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:20.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:13.333333333333334%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                </div>
                <div style="position:absolute; left:40px; right:0; bottom:0; height:25px; display:flex; justify-content:space-between; padding:0 2px;">
        
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-3</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-2</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-1</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">0</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">1</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">2</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">3</div>
            
                </div>
            </div>
        
            <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:6px; letter-spacing:0.01em;">
                mean = 0.11 <span style="opacity:0.7;">(95% confidence interval: -0.42–0.65)</span>
            </div>
            
        </div>
        
    </div>
  </div>
</div> 
                  </div>
                  
                
              
                
                  <div class="col-md-6 col-lg-4 mb-4 opinion-histogram-card" data-index="0">
                    <!-- Individual Opinion Histogram Card -->
<div class="card histogram-card">
  <div class="card-body p-0 px-1 position-relative">
    <div class="histogram-content">
      
        <div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:25px;">
            <div style="font-size:1.25rem; font-weight:500; margin-bottom:15px;">Patient Autonomy</div>
            <div style="position:relative; height:175px; width:100%; margin-bottom:10px;">
                <!-- Y-axis -->
                <div style="position:absolute; top:0; left:0; bottom:25px; width:40px; display:flex; flex-direction:column; justify-content:space-between;">
        
                    <div style="position:absolute; top:0.0%; right:10px; color:#a9adc1; font-size:14px;">15</div>
            
                    <div style="position:absolute; top:33.33333333333333%; right:10px; color:#a9adc1; font-size:14px;">10</div>
            
                    <div style="position:absolute; top:66.66666666666666%; right:10px; color:#a9adc1; font-size:14px;">5</div>
            
                    <div style="position:absolute; top:100.0%; right:10px; color:#a9adc1; font-size:14px;">0</div>
            
                    <div style="position:absolute; top:0; bottom:0; right:0; width:1px; background:rgba(169,173,193,0.3);"></div>
                </div>
                
                <!-- Horizontal grid lines -->
                <div style="position:absolute; top:0; left:40px; right:0; bottom:25px;">
        
                    <div style="position:absolute; top:0.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:33.33333333333333%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:66.66666666666666%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                    <div style="position:absolute; top:100.0%; left:0; right:0; height:1px; background:rgba(169,173,193,0.15);"></div>
            
                </div>
                <div style="position:absolute; top:0; left:40px; right:0; bottom:25px; display:flex; align-items:flex-end; justify-content:space-between; padding:0 2px;">
        
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:0.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:6.666666666666667%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:60.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:20.0%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:46.666666666666664%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:73.33333333333333%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                    <div style="flex:1; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-end;">
                        <div style="width:70%; height:26.666666666666668%; background:linear-gradient(180deg, #a5a5ff 0%, #8888ff 100%); 
                                    border-radius:4px 4px 0 0; box-shadow:0 0 10px rgba(138,138,255,0.2);"></div>
                    </div>
            
                </div>
                <div style="position:absolute; left:40px; right:0; bottom:0; height:25px; display:flex; justify-content:space-between; padding:0 2px;">
        
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-3</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-2</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">-1</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">0</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">1</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">2</div>
            
                    <div style="flex:1; text-align:center; color:#a9adc1; font-size:16px; font-weight:500;">3</div>
            
                </div>
            </div>
        
            <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:6px; letter-spacing:0.01em;">
                mean = 0.86 <span style="opacity:0.7;">(95% confidence interval: 0.35–1.36)</span>
            </div>
            
        </div>
        
    </div>
  </div>
</div> 
                  </div>
                  
                
              
            </div>
            <div class="text-center">
              <button id="show-more-histograms-btn" class="btn btn-thread-toggle show-toggle-btn" style="display:none;">Show More Figures</button>
              <button id="show-fewer-histograms-btn" class="btn btn-thread-toggle show-toggle-btn" style="display:none;">Show Fewer Figures</button>
            </div>
          
        </div>
      </div>
      <div class="row mb-4">
        <div class="col-12">
          <div class="py-4">
            <!-- Report Section Partial -->

<h5 class="section-title">
  <div class="title-text">
    <i class="fas fa-file-alt mr-1"></i> Instructor Report
  </div>
  
</h5>

<!-- DEBUG: Show if report or has_saved_summaries are missing -->



<div class="card-body" id="report-section">
  
    
    <div id="report-content" class="markdown-content">
      <p>Students debated the balance between patient autonomy and medical paternalism, the ethics of amputation for Body Integrity Identity Disorder (BIID), and the appropriateness of "nudging" in medical decision-making. They engaged in pairs (occasionally trios) to debate these complex ethical dilemmas, with Guide prompting them to deepen their analysis, consider different perspectives, and develop nuanced positions on controversial medical ethics topics.</p>
<h3>Themes</h3>
<ul>
<li><strong>Patient autonomy versus medical paternalism formed a central tension across discussions.</strong> Students wrestled with defining the boundaries of appropriate physician intervention, frequently concluding that paternalism is justified primarily when decision-making capacity is impaired, though they differed on the threshold for intervention and whether potential welfare gains could justify overriding autonomy in certain cases.</li>
<li><strong>The concept of informed consent emerged as a cornerstone of ethical medical practice.</strong> Students generally agreed that full disclosure of treatment options and risks is essential for maintaining trust in doctor-patient relationships, though they debated whether simplifying information or framing options in certain ways constitutes helpful guidance or unethical manipulation.</li>
<li><strong>Students consistently advocated for robust safeguards when considering controversial treatments.</strong> Across discussions on amputation for BIID and cases of medical paternalism, students emphasized the importance of psychiatric evaluations, second opinions, ethics committees, and exhausting non-invasive alternatives before pursuing irreversible interventions.</li>
</ul>
<h3>Guide's Role</h3>
<ul>
<li><strong>Guide consistently challenged students to move beyond abstract principles to concrete applications.</strong> When discussions remained theoretical, Guide introduced specific scenarios—such as DNR orders, emergency situations, and cultural differences in medical decision-making—prompting students to test their ethical frameworks against complex real-world cases.</li>
<li><strong>Guide pushed students to refine imprecise concepts and reveal hidden assumptions.</strong> By asking students to clarify terms like "sufficiently high" gain, "right state of mind," or what constitutes unethical "nudging," Guide helped participants articulate more precise ethical positions and recognize when they were relying on unstated assumptions about patient welfare or capacity.</li>
<li><strong>Guide modeled intellectual humility while maintaining rigorous standards of evidence.</strong> When students made claims about treatment effectiveness or patient outcomes, Guide pressed for empirical support and consideration of counterevidence, encouraging them to consider both sides of contentious issues while avoiding simplistic or dogmatic positions.</li>
</ul>
<h3>Common Ground</h3>
<ul>
<li><strong>Students widely agreed that psychological evaluation should precede major medical interventions.</strong> Across discussions of both paternalism and BIID treatment, students consistently endorsed thorough mental health assessments as a prerequisite for either overriding patient autonomy or proceeding with irreversible treatments, showing consensus on the importance of establishing decision-making capacity.</li>
<li><strong>Most students concluded that while patient autonomy is paramount, it is not absolute.</strong> There was broad agreement that in cases of severely impaired decision-making capacity or immediate risk of harm, medical professionals may sometimes be justified in acting against a patient's stated wishes, though they emphasized the need for temporary and minimal interventions.</li>
<li><strong>Students converged on the need for transparent communication in medical contexts.</strong> Even when debating the ethics of "nudging," students generally agreed that physicians should provide complete information while acknowledging their expertise, with any guidance or framing explicitly disclosed rather than manipulatively implemented.</li>
</ul>
<h3>Persistent Disagreements</h3>
<ul>
<li><strong>Students remained divided on whether amputation could ever be an ethical treatment for BIID.</strong> Some argued that surgery might be justified as a last resort when all other treatments fail and psychological distress is severe, while others maintained that physicians should never participate in removing healthy limbs regardless of patient distress or consent, viewing it as a violation of medical ethics.</li>
<li><strong>The appropriate threshold for paternalistic intervention sparked ongoing debate.</strong> While students generally agreed intervention is justified for unconscious patients or those with severe cognitive impairments, they disagreed about more ambiguous cases involving religious beliefs, cultural differences, or temporary emotional distress, revealing tensions between respecting diverse values and preventing potential harm.</li>
</ul>
<h3>Insights</h3>
<ul>
<li><strong>Students thoughtfully engaged with the disability rights perspective when discussing BIID.</strong> Some discussions evolved beyond medical considerations to explore disability as a neutral or even empowering identity rather than a deficit, demonstrating sophisticated understanding of how medical ethics intersects with broader social and political considerations around bodily autonomy and identity.</li>
<li><strong>The historical context of medical mistrust emerged as an important consideration in several discussions.</strong> Students recognized that marginalized communities may have legitimate reasons for skepticism toward medical authority, suggesting that rebuilding trust through transparent communication and cultural competence is essential for ethical care beyond theoretical principles of autonomy and beneficence.</li>
</ul>
<h3>Possible Misconceptions</h3>
<ul>
<li><strong>Some discussions appeared to conflate BIID (Body Integrity Identity Disorder) with apotemnophilia.</strong> While students often used these terms interchangeably, research suggests they may represent different conditions—BIID typically refers to a neurological condition involving body map incongruence, while apotemnophilia has sometimes been associated with sexual arousal, though terminology in this field is still evolving.</li>
<li><strong>Discussions occasionally oversimplified the availability and effectiveness of psychiatric treatments.</strong> Some students assumed that therapy and medication would be effective alternatives to surgical intervention for conditions like BIID, whereas available evidence suggests these conditions often prove resistant to conventional psychiatric approaches, potentially complicating the ethical calculus.</li>
</ul>
    </div>
    <!-- Hidden raw markdown for test compatibility -->
    <div style="display:none;" id="report-raw-markdown">This university-level discussion assignment focused on medical ethics, with students examining the balance between patient autonomy and medical paternalism, the ethics of amputation for Body Integrity Identity Disorder (BIID), and the appropriateness of "nudging" in medical decision-making. Students engaged in pairs (occasionally trios) to debate these complex ethical dilemmas, with Guide prompting them to deepen their analysis, consider different perspectives, and develop nuanced positions on controversial medical ethics topics.

### Themes
- **Patient autonomy versus medical paternalism formed a central tension across discussions.** Students wrestled with defining the boundaries of appropriate physician intervention, frequently concluding that paternalism is justified primarily when decision-making capacity is impaired, though they differed on the threshold for intervention and whether potential welfare gains could justify overriding autonomy in certain cases.
- **The concept of informed consent emerged as a cornerstone of ethical medical practice.** Students generally agreed that full disclosure of treatment options and risks is essential for maintaining trust in doctor-patient relationships, though they debated whether simplifying information or framing options in certain ways constitutes helpful guidance or unethical manipulation.
- **Students consistently advocated for robust safeguards when considering controversial treatments.** Across discussions on amputation for BIID and cases of medical paternalism, students emphasized the importance of psychiatric evaluations, second opinions, ethics committees, and exhausting non-invasive alternatives before pursuing irreversible interventions.

### Guide's Role
- **Guide consistently challenged students to move beyond abstract principles to concrete applications.** When discussions remained theoretical, Guide introduced specific scenarios—such as DNR orders, emergency situations, and cultural differences in medical decision-making—prompting students to test their ethical frameworks against complex real-world cases.
- **Guide pushed students to refine imprecise concepts and reveal hidden assumptions.** By asking students to clarify terms like "sufficiently high" gain, "right state of mind," or what constitutes unethical "nudging," Guide helped participants articulate more precise ethical positions and recognize when they were relying on unstated assumptions about patient welfare or capacity.
- **Guide modeled intellectual humility while maintaining rigorous standards of evidence.** When students made claims about treatment effectiveness or patient outcomes, Guide pressed for empirical support and consideration of counterevidence, encouraging them to consider both sides of contentious issues while avoiding simplistic or dogmatic positions.

### Common Ground
- **Students widely agreed that psychological evaluation should precede major medical interventions.** Across discussions of both paternalism and BIID treatment, students consistently endorsed thorough mental health assessments as a prerequisite for either overriding patient autonomy or proceeding with irreversible treatments, showing consensus on the importance of establishing decision-making capacity.
- **Most students concluded that while patient autonomy is paramount, it is not absolute.** There was broad agreement that in cases of severely impaired decision-making capacity or immediate risk of harm, medical professionals may sometimes be justified in acting against a patient's stated wishes, though they emphasized the need for temporary and minimal interventions.
- **Students converged on the need for transparent communication in medical contexts.** Even when debating the ethics of "nudging," students generally agreed that physicians should provide complete information while acknowledging their expertise, with any guidance or framing explicitly disclosed rather than manipulatively implemented.

### Persistent Disagreements
- **Students remained divided on whether amputation could ever be an ethical treatment for BIID.** Some argued that surgery might be justified as a last resort when all other treatments fail and psychological distress is severe, while others maintained that physicians should never participate in removing healthy limbs regardless of patient distress or consent, viewing it as a violation of medical ethics.
- **The appropriate threshold for paternalistic intervention sparked ongoing debate.** While students generally agreed intervention is justified for unconscious patients or those with severe cognitive impairments, they disagreed about more ambiguous cases involving religious beliefs, cultural differences, or temporary emotional distress, revealing tensions between respecting diverse values and preventing potential harm.

### Insights
- **Students thoughtfully engaged with the disability rights perspective when discussing BIID.** Some discussions evolved beyond medical considerations to explore disability as a neutral or even empowering identity rather than a deficit, demonstrating sophisticated understanding of how medical ethics intersects with broader social and political considerations around bodily autonomy and identity.
- **The historical context of medical mistrust emerged as an important consideration in several discussions.** Students recognized that marginalized communities may have legitimate reasons for skepticism toward medical authority, suggesting that rebuilding trust through transparent communication and cultural competence is essential for ethical care beyond theoretical principles of autonomy and beneficence.

### Possible Misconceptions
- **Some discussions appeared to conflate BIID (Body Integrity Identity Disorder) with apotemnophilia.** While students often used these terms interchangeably, research suggests they may represent different conditions—BIID typically refers to a neurological condition involving body map incongruence, while apotemnophilia has sometimes been associated with sexual arousal, though terminology in this field is still evolving.
- **Discussions occasionally oversimplified the availability and effectiveness of psychiatric treatments.** Some students assumed that therapy and medication would be effective alternatives to surgical intervention for conditions like BIID, whereas available evidence suggests these conditions often prove resistant to conventional psychiatric approaches, potentially complicating the ethical calculus.</div>
    <!-- RAW REPORT CONTENT FOR TESTING: This university-leve -->
    <span style="display:none;" id="report-prefix">This university-leve</span>
    <div class="text-muted mt-2 d-flex justify-content-end align-items-center">
      <span class="text-right" style="flex:1; text-align:right;">Generated on: 
        <script>
          document.write(new Date("2025-05-06T15:08:01.301013").toLocaleDateString('en-US', {
            month: 'short', 
            day: 'numeric', 
            year: 'numeric',
            hour: 'numeric',
            minute: '2-digit',
            hour12: true
          }));
        </script>
        <noscript>2025-05-06T15:08:01.301013</noscript>
      </span>
      
    </div>
    <div id="report-editor-container" style="display: none;">
      <div class="alert alert-info">
        <i class="fas fa-info-circle mr-2"></i> Edit the report in markdown format.
      </div>
      <textarea id="report-markdown-editor" class="form-control">This university-level discussion assignment focused on medical ethics, with students examining the balance between patient autonomy and medical paternalism, the ethics of amputation for Body Integrity Identity Disorder (BIID), and the appropriateness of &#34;nudging&#34; in medical decision-making. Students engaged in pairs (occasionally trios) to debate these complex ethical dilemmas, with Guide prompting them to deepen their analysis, consider different perspectives, and develop nuanced positions on controversial medical ethics topics.

### Themes
- **Patient autonomy versus medical paternalism formed a central tension across discussions.** Students wrestled with defining the boundaries of appropriate physician intervention, frequently concluding that paternalism is justified primarily when decision-making capacity is impaired, though they differed on the threshold for intervention and whether potential welfare gains could justify overriding autonomy in certain cases.
- **The concept of informed consent emerged as a cornerstone of ethical medical practice.** Students generally agreed that full disclosure of treatment options and risks is essential for maintaining trust in doctor-patient relationships, though they debated whether simplifying information or framing options in certain ways constitutes helpful guidance or unethical manipulation.
- **Students consistently advocated for robust safeguards when considering controversial treatments.** Across discussions on amputation for BIID and cases of medical paternalism, students emphasized the importance of psychiatric evaluations, second opinions, ethics committees, and exhausting non-invasive alternatives before pursuing irreversible interventions.

### Guide&#39;s Role
- **Guide consistently challenged students to move beyond abstract principles to concrete applications.** When discussions remained theoretical, Guide introduced specific scenarios—such as DNR orders, emergency situations, and cultural differences in medical decision-making—prompting students to test their ethical frameworks against complex real-world cases.
- **Guide pushed students to refine imprecise concepts and reveal hidden assumptions.** By asking students to clarify terms like &#34;sufficiently high&#34; gain, &#34;right state of mind,&#34; or what constitutes unethical &#34;nudging,&#34; Guide helped participants articulate more precise ethical positions and recognize when they were relying on unstated assumptions about patient welfare or capacity.
- **Guide modeled intellectual humility while maintaining rigorous standards of evidence.** When students made claims about treatment effectiveness or patient outcomes, Guide pressed for empirical support and consideration of counterevidence, encouraging them to consider both sides of contentious issues while avoiding simplistic or dogmatic positions.

### Common Ground
- **Students widely agreed that psychological evaluation should precede major medical interventions.** Across discussions of both paternalism and BIID treatment, students consistently endorsed thorough mental health assessments as a prerequisite for either overriding patient autonomy or proceeding with irreversible treatments, showing consensus on the importance of establishing decision-making capacity.
- **Most students concluded that while patient autonomy is paramount, it is not absolute.** There was broad agreement that in cases of severely impaired decision-making capacity or immediate risk of harm, medical professionals may sometimes be justified in acting against a patient&#39;s stated wishes, though they emphasized the need for temporary and minimal interventions.
- **Students converged on the need for transparent communication in medical contexts.** Even when debating the ethics of &#34;nudging,&#34; students generally agreed that physicians should provide complete information while acknowledging their expertise, with any guidance or framing explicitly disclosed rather than manipulatively implemented.

### Persistent Disagreements
- **Students remained divided on whether amputation could ever be an ethical treatment for BIID.** Some argued that surgery might be justified as a last resort when all other treatments fail and psychological distress is severe, while others maintained that physicians should never participate in removing healthy limbs regardless of patient distress or consent, viewing it as a violation of medical ethics.
- **The appropriate threshold for paternalistic intervention sparked ongoing debate.** While students generally agreed intervention is justified for unconscious patients or those with severe cognitive impairments, they disagreed about more ambiguous cases involving religious beliefs, cultural differences, or temporary emotional distress, revealing tensions between respecting diverse values and preventing potential harm.

### Insights
- **Students thoughtfully engaged with the disability rights perspective when discussing BIID.** Some discussions evolved beyond medical considerations to explore disability as a neutral or even empowering identity rather than a deficit, demonstrating sophisticated understanding of how medical ethics intersects with broader social and political considerations around bodily autonomy and identity.
- **The historical context of medical mistrust emerged as an important consideration in several discussions.** Students recognized that marginalized communities may have legitimate reasons for skepticism toward medical authority, suggesting that rebuilding trust through transparent communication and cultural competence is essential for ethical care beyond theoretical principles of autonomy and beneficence.

### Possible Misconceptions
- **Some discussions appeared to conflate BIID (Body Integrity Identity Disorder) with apotemnophilia.** While students often used these terms interchangeably, research suggests they may represent different conditions—BIID typically refers to a neurological condition involving body map incongruence, while apotemnophilia has sometimes been associated with sexual arousal, though terminology in this field is still evolving.
- **Discussions occasionally oversimplified the availability and effectiveness of psychiatric treatments.** Some students assumed that therapy and medication would be effective alternatives to surgical intervention for conditions like BIID, whereas available evidence suggests these conditions often prove resistant to conventional psychiatric approaches, potentially complicating the ethical calculus.</textarea>
      <div class="mt-3">
        <button id="save-report-btn" class="btn btn-primary">
          <i class="fas fa-save mr-1"></i> Save Changes
        </button>
        <button id="cancel-report-edit-btn" class="btn btn-secondary ml-2">
          <i class="fas fa-times mr-1"></i> Cancel
        </button>
        <span id="editor-spinner" class="spinner-border spinner-border-sm ml-2" role="status" style="display: none;"></span>
      </div>
      <div id="editor-status-message" class="status-message mt-3" style="display: none;"></div>
    </div>
  
</div> 
          </div>
        </div>
      </div>

      <div class="row mb-2">
        <div class="col-12">
          <h5 class="section-title">
            <div class="title-text"><i class="fas fa-comments mr-1"></i> Chat Threads</div>
            
          </h5>
        </div>
        <div class="pt-0 pb-2">
          <!-- DEBUG: Show if threads is missing or empty -->
          
          <div class="text-muted small mb-0 section-info-align">
            <i class="fas fa-info-circle mr-1"></i> Only threads with 10 or more messages are shown and processed for summaries. Student names are redacted for privacy.
          </div>
        </div>
      </div>

      <!-- Separate row for thread items floating on background -->
      <div class="row mb-5">
        <div class="col-12">
          <div class="thread-list" id="thread-list">
            
              <div class="masonry-grid">
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556">
                                  <ul>
<li><strong>Students critically examined the ethical and medical challenges of using amputation as a treatment for apotemnophilia.</strong> They weighed the irreversible risks of surgery against potential mental health relief, discussing the balance between subjective experiences and objective medical metrics while considering comprehensive evaluations and screening processes. </li>
<li><strong>Students navigated complex issues of patient autonomy, informed consent, and the ethical implications of body modification.</strong> Their conversation evolved to include concerns about treatment regret, standardized assessments, and long-term outcomes as they questioned when irreversible procedures might be defensible under strict ethical safeguards.</li>
</ul>
<blockquote>
<p><strong>Student 2, you've raised some important concerns about the risks of amputation. However, I'd like to challenge you to consider Student 1's point about mental illness more deeply. How might your approach change if we consider apotemnophilia as a genuine psychological condition rather than a desire for cool points?</strong></p>
<p><strong>Consider the ethical implications of denying treatment to someone suffering from severe psychological distress. What are the potential consequences of refusing to perform these procedures, both for the individual and for society?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students critically examined the ethical and medical challenges of using amputation as a treatment for apotemnophilia.** They weighed the irreversible risks of surgery against potential mental health relief, discussing the balance between subjective experiences and objective medical metrics while considering comprehensive evaluations and screening processes. 
- **Students navigated complex issues of patient autonomy, informed consent, and the ethical implications of body modification.** Their conversation evolved to include concerns about treatment regret, standardized assessments, and long-term outcomes as they questioned when irreversible procedures might be defensible under strict ethical safeguards.

&gt; **Student 2, you&#39;ve raised some important concerns about the risks of amputation. However, I&#39;d like to challenge you to consider Student 1&#39;s point about mental illness more deeply. How might your approach change if we consider apotemnophilia as a genuine psychological condition rather than a desire for cool points?**
&gt;
&gt; **Consider the ethical implications of denying treatment to someone suffering from severe psychological distress. What are the potential consequences of refusing to perform these procedures, both for the individual and for society?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==349f5f32df::student-dwfilmvkdq==be8e2cdede::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556">
                                  <ul>
<li><strong>Students began by agreeing that amputation must be a last resort, then mapped out non-surgical alternatives and consent safeguards.</strong> They initially focused on therapy, medications, limb restrictions, and rigorous mental-health evaluations before even considering irreversible surgery. Over time they acknowledged amputation might sometimes be the “least harmful” option if distress is extreme and all other measures fail.  </li>
<li><strong>Guide steered the conversation with targeted ethical and practical prompts, pushing students to analyze consent capacity, long-term desire, and societal trade-offs.</strong> By asking how to verify informed consent, balance autonomy against broader implications, and factor in insurance and technology, Guide kept the debate both nuanced and forward-looking.  </li>
<li><strong>Students flagged financial barriers could push individuals toward unsafe “street” surgeries, then unexpectedly framed disability through a rights-based lens as a neutral or empowering identity.</strong> This evolution illustrates how discussions moved from clinical risks to socio-political dimensions, acknowledging both access inequities and the potential for shifting cultural narratives.  </li>
</ul>
<blockquote>
<p><strong>What if these non-surgical alternatives fail to alleviate the patient's distress? Should amputation ever be considered as a last resort, or is it always unethical? Consider the patient's autonomy and quality of life in your response.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students began by agreeing that amputation must be a last resort, then mapped out non-surgical alternatives and consent safeguards.** They initially focused on therapy, medications, limb restrictions, and rigorous mental-health evaluations before even considering irreversible surgery. Over time they acknowledged amputation might sometimes be the “least harmful” option if distress is extreme and all other measures fail.  
- **Guide steered the conversation with targeted ethical and practical prompts, pushing students to analyze consent capacity, long-term desire, and societal trade-offs.** By asking how to verify informed consent, balance autonomy against broader implications, and factor in insurance and technology, Guide kept the debate both nuanced and forward-looking.  
- **Students flagged financial barriers could push individuals toward unsafe “street” surgeries, then unexpectedly framed disability through a rights-based lens as a neutral or empowering identity.** This evolution illustrates how discussions moved from clinical risks to socio-political dimensions, acknowledging both access inequities and the potential for shifting cultural narratives.  


&gt; **What if these non-surgical alternatives fail to alleviate the patient&#39;s distress? Should amputation ever be considered as a last resort, or is it always unethical? Consider the patient&#39;s autonomy and quality of life in your response.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==7c87150edd::student-dwfilmvkdq==ed70a0f2dd::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Medical Paternalism
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556">
                                  <ul>
<li><strong>Students debated the justifiability of medical paternalism in crisis situations.</strong> They explored scenarios where doctors may need to override patient autonomy, weighing factors like mental capacity assessments, emergency conditions, and cultural influences that affect decision-making.  </li>
<li><strong>Guide pushed the discussion deeper with targeted challenges to student assumptions.</strong> It probed the limitations of psychiatric evaluations, the risk of prolonged paternalism, and the impact of cultural competency on patient care, urging students to assess the practical and ethical trade-offs in detail.  </li>
</ul>
<blockquote>
<p><strong>Student 2, how might we address the risk of doctors becoming overly paternalistic, potentially prolonging intervention even as patients recover? Student 1, what safeguards could prevent abuse of medical paternalism in mental health contexts? Consider factors like cultural differences, socioeconomic status, or implicit biases that may hinder objective assessments in emergency scenarios.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556" class="form-control summary-markdown-editor">- **Students debated the justifiability of medical paternalism in crisis situations.** They explored scenarios where doctors may need to override patient autonomy, weighing factors like mental capacity assessments, emergency conditions, and cultural influences that affect decision-making.  
- **Guide pushed the discussion deeper with targeted challenges to student assumptions.** It probed the limitations of psychiatric evaluations, the risk of prolonged paternalism, and the impact of cultural competency on patient care, urging students to assess the practical and ethical trade-offs in detail.  

&gt; **Student 2, how might we address the risk of doctors becoming overly paternalistic, potentially prolonging intervention even as patients recover? Student 1, what safeguards could prevent abuse of medical paternalism in mental health contexts? Consider factors like cultural differences, socioeconomic status, or implicit biases that may hinder objective assessments in emergency scenarios.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==00e8d13cdf::student-dwfilmvkdq==144d2402de::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Patient Autonomy
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556">
                                  <ul>
<li><strong>Students debated nudging versus pure information-sharing under patient autonomy, with Student 2 arguing nudges help guide decisions and Student 1 warning it risks withholding information.</strong> They eventually agreed that while doctors should frame information to aid comprehension, they must avoid pressure that could violate patient rights.  </li>
<li><strong>The discussion deepened as they considered scenarios where nudging might backfire, cultural differences in patient responses, and the role of physician bias.</strong> Both students shifted towards a balanced approach, suggesting transparency, asking about patient values, training, second opinions, and outcome data to mitigate unintended influence.  </li>
<li><strong>Guide maintained momentum by asking pointed, multi-angle ethical questions that pushed students to explore potential drawbacks, cultural sensitivity, and bias controls.</strong> Its targeted prompts guided the pair from abstract principles to concrete examples, sustaining engagement despite frequent procedural queries from Student 2.</li>
</ul>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556" class="form-control summary-markdown-editor">- **Students debated nudging versus pure information-sharing under patient autonomy, with Student 2 arguing nudges help guide decisions and Student 1 warning it risks withholding information.** They eventually agreed that while doctors should frame information to aid comprehension, they must avoid pressure that could violate patient rights.  
- **The discussion deepened as they considered scenarios where nudging might backfire, cultural differences in patient responses, and the role of physician bias.** Both students shifted towards a balanced approach, suggesting transparency, asking about patient values, training, second opinions, and outcome data to mitigate unintended influence.  
- **Guide maintained momentum by asking pointed, multi-angle ethical questions that pushed students to explore potential drawbacks, cultural sensitivity, and bias controls.** Its targeted prompts guided the pair from abstract principles to concrete examples, sustaining engagement despite frequent procedural queries from Student 2.</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==24cd2638dd::student-dwfilmvkdq==2f766320dd::4c71986d1b::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556">
                                  <ul>
<li><strong>Students weighed the ethics of elective amputation for apotemnophilia, with Student 1 endorsing it as a last-resort “treatment” when psychological care fails and Student 2 demanding robust evidence before consenting.</strong> They initially diverged—Student 1 framed amputation as analogous to psychiatric medication for intractable distress and a matter of personal autonomy, while Student 2 warned against disabling healthy limbs without clear quality-of-life data—but gradually found common ground in the need for psychiatric screening and outcome studies.  </li>
<li><strong>Guide steered the debate by invoking parallels with gender-affirming and cosmetic surgeries, pressing for concrete evidence, and spotlighting the balance between patient autonomy and professional oversight.</strong> Its successive prompts led students to outline screening protocols, propose standardized diagnostic checklists to curb cultural and personal biases, and consider when it might be ethically incumbent to refuse amputation requests despite patient consent.  </li>
</ul>
<blockquote>
<p><strong>What evidence would you need to see to consider amputation as a valid treatment for apotemnophilia? Consider long-term outcome studies, patient satisfaction rates, and quality of life improvements. How might this data influence your view on the ethics of this procedure?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students weighed the ethics of elective amputation for apotemnophilia, with Student 1 endorsing it as a last-resort “treatment” when psychological care fails and Student 2 demanding robust evidence before consenting.** They initially diverged—Student 1 framed amputation as analogous to psychiatric medication for intractable distress and a matter of personal autonomy, while Student 2 warned against disabling healthy limbs without clear quality-of-life data—but gradually found common ground in the need for psychiatric screening and outcome studies.  
- **Guide steered the debate by invoking parallels with gender-affirming and cosmetic surgeries, pressing for concrete evidence, and spotlighting the balance between patient autonomy and professional oversight.** Its successive prompts led students to outline screening protocols, propose standardized diagnostic checklists to curb cultural and personal biases, and consider when it might be ethically incumbent to refuse amputation requests despite patient consent.  


&gt; **What evidence would you need to see to consider amputation as a valid treatment for apotemnophilia? Consider long-term outcome studies, patient satisfaction rates, and quality of life improvements. How might this data influence your view on the ethics of this procedure?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==1484d00edd::student-dwfilmvkdq==f340be7edd::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Patient Autonomy
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556">
                                  <ul>
<li><strong>Students intensely debated the balance between objective truth and physician influence.</strong> They discussed whether a doctor’s selective presentation of treatment options merely reflects professional judgment or crosses into unethical nudging, with one side arguing that any deviation from complete truth risks eroding trust while the other stressed the need for practical decision-making in complex medical scenarios.</li>
<li><strong>Guide skillfully probed the ethical boundaries of nudging in patient care.</strong> It repeatedly challenged the discussion by asking nuanced questions about the difference between sharing expert opinions and inappropriately swaying patient decisions, pushing the students to clarify how much information should be provided despite potential overwhelm.</li>
</ul>
<blockquote>
<p><strong>Student 1, you've brought us back to the core issue of misleading or nudging patients. What do you think constitutes nudging in a medical context? Is there a difference between a doctor strongly recommending an option based on evidence and inappropriately influencing a patient's decision? How can we distinguish between the two?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556" class="form-control summary-markdown-editor">- **Students intensely debated the balance between objective truth and physician influence.** They discussed whether a doctor’s selective presentation of treatment options merely reflects professional judgment or crosses into unethical nudging, with one side arguing that any deviation from complete truth risks eroding trust while the other stressed the need for practical decision-making in complex medical scenarios.
- **Guide skillfully probed the ethical boundaries of nudging in patient care.** It repeatedly challenged the discussion by asking nuanced questions about the difference between sharing expert opinions and inappropriately swaying patient decisions, pushing the students to clarify how much information should be provided despite potential overwhelm.

  
&gt; **Student 1, you&#39;ve brought us back to the core issue of misleading or nudging patients. What do you think constitutes nudging in a medical context? Is there a difference between a doctor strongly recommending an option based on evidence and inappropriately influencing a patient&#39;s decision? How can we distinguish between the two?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==a15461fcdf::student-dwfilmvkdq==fa671a3cdf::4c71986d1b::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Patient Autonomy
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556">
                                  <ul>
<li><strong>Students began with opposing views on medical paternalism and patient autonomy but quickly converged on the importance of full disclosure while distinguishing between “intervention” and “manipulation.”</strong> They navigated scenarios from low-success treatments to emergency exceptions, emphasized the need for mental health support, and stressed that withholding or distorting information undermines informed consent.  </li>
<li><strong>Guide continually challenged assumptions and steered the debate toward nuanced ethical boundaries in clinical practice.</strong> It asked pointed questions about the downsides of listing every option, the ethics of nudging versus manipulation, and how time constraints and patient psychology can complicate genuine informed consent.  </li>
</ul>
<blockquote>
<p><strong>You've made a strong case for patient autonomy and against medical paternalism. Can you think of any situations where a doctor's expertise might justify some degree of 'nudging' a patient towards a particular treatment option? Consider cases where a patient's immediate desires might conflict with their long-term well-being.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556" class="form-control summary-markdown-editor">- **Students began with opposing views on medical paternalism and patient autonomy but quickly converged on the importance of full disclosure while distinguishing between “intervention” and “manipulation.”** They navigated scenarios from low-success treatments to emergency exceptions, emphasized the need for mental health support, and stressed that withholding or distorting information undermines informed consent.  
- **Guide continually challenged assumptions and steered the debate toward nuanced ethical boundaries in clinical practice.** It asked pointed questions about the downsides of listing every option, the ethics of nudging versus manipulation, and how time constraints and patient psychology can complicate genuine informed consent.  


&gt; **You&#39;ve made a strong case for patient autonomy and against medical paternalism. Can you think of any situations where a doctor&#39;s expertise might justify some degree of &#39;nudging&#39; a patient towards a particular treatment option? Consider cases where a patient&#39;s immediate desires might conflict with their long-term well-being.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==54f3bcccde::student-z21hawwuy29t727419eee7::4c71986d1b::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556">
                                  <ul>
<li>
<p><strong>Students discussed whether amputation should be used to treat apotemnophilia, stressing the need for alternatives and strict evaluation.</strong> Student 1 argued that therapy and medication should be prioritized over irreversible surgical procedures, warning against a slippery slope of further amputations, while Student 2 maintained that amputation could be considered only after thorough, long-term evaluations to prevent self-harm and mitigate mimicry risks.</p>
</li>
<li>
<p><strong>Students debated the ethics and practicality of a detailed screening process before considering amputation.</strong> They proposed multiple criteria, including extensive psychiatric evaluations, real-life exposure to post-amputation outcomes, and a timeline spanning months to years, keying in on the potential negative influence of social media and the risk of normalizing extreme measures.</p>
</li>
<li>
<p><strong>Guide played a pivotal role by challenging assumptions and urging deeper examination of treatment risks versus benefits.</strong> It consistently pressed for more concrete evidence and ethical justification, pushing the discussion towards details that balanced patients’ quality of life with responsible medical practice.  </p>
</li>
</ul>
<blockquote>
<p><strong>Student 2, you raise an important point about the potential risks of amputation as a treatment. Can you elaborate on why you believe medication or therapy would be more effective for treating apotemnophilia? Additionally, I'd like to challenge your assumption that amputation would necessarily lead to a desire for further amputations. What evidence supports this view?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students discussed whether amputation should be used to treat apotemnophilia, stressing the need for alternatives and strict evaluation.** Student 1 argued that therapy and medication should be prioritized over irreversible surgical procedures, warning against a slippery slope of further amputations, while Student 2 maintained that amputation could be considered only after thorough, long-term evaluations to prevent self-harm and mitigate mimicry risks.

- **Students debated the ethics and practicality of a detailed screening process before considering amputation.** They proposed multiple criteria, including extensive psychiatric evaluations, real-life exposure to post-amputation outcomes, and a timeline spanning months to years, keying in on the potential negative influence of social media and the risk of normalizing extreme measures.

- **Guide played a pivotal role by challenging assumptions and urging deeper examination of treatment risks versus benefits.** It consistently pressed for more concrete evidence and ethical justification, pushing the discussion towards details that balanced patients’ quality of life with responsible medical practice.  

&gt; **Student 2, you raise an important point about the potential risks of amputation as a treatment. Can you elaborate on why you believe medication or therapy would be more effective for treating apotemnophilia? Additionally, I&#39;d like to challenge your assumption that amputation would necessarily lead to a desire for further amputations. What evidence supports this view?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==334ea102df::student-dwfilmvkdq==b03ab1d0df::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Patient Autonomy
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556">
                                  <ul>
<li><strong>Students debated the ethics of nudging in patient care.</strong> They weighed the value of a physician’s informed recommendation against the risks of misleading or overly influencing a patient’s decision, with both sides stressing the importance of transparent communication and the balance between expert opinion and patient autonomy.</li>
<li><strong>Guide challenged the students to probe deeper into the nuances of nudging and ethical guidance.</strong> It asked incisive questions about distinguishing ethical guidance from unethical nudging and determining the point at which doctors should ease off to respect patient autonomy while still ensuring safety.</li>
</ul>
<blockquote>
<p><strong>Student 2, you've raised a critical point about the limits of nudging. How do you think we should determine when a doctor should "back off"? Consider factors like patient capacity, severity of consequences, and potential for harm to others.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556" class="form-control summary-markdown-editor">- **Students debated the ethics of nudging in patient care.** They weighed the value of a physician’s informed recommendation against the risks of misleading or overly influencing a patient’s decision, with both sides stressing the importance of transparent communication and the balance between expert opinion and patient autonomy.
- **Guide challenged the students to probe deeper into the nuances of nudging and ethical guidance.** It asked incisive questions about distinguishing ethical guidance from unethical nudging and determining the point at which doctors should ease off to respect patient autonomy while still ensuring safety.

&gt; **Student 2, you&#39;ve raised a critical point about the limits of nudging. How do you think we should determine when a doctor should &#34;back off&#34;? Consider factors like patient capacity, severity of consequences, and potential for harm to others.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==2cdff190df::student-dwfilmvkdq==c0f33c0ade::4c71986d1b::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556">
                                  <ul>
<li><strong>Students grappled with whether amputation can ethically treat apotemnophilia by weighing life-saving rationale against body identity distress.</strong> Student 1 argued that removing healthy limbs could relieve profound suffering in BIID, while Student 2 initially rejected elective cuts but softened after discussing childhood-onset desires and positive post-surgery testimonials.  </li>
<li><strong>Guide kept the conversation focused by insisting on clear definitions, challenging assumptions, and prompting ethical and procedural safeguards.</strong> Through targeted questions about distinguishing necessary amputations from identity-driven ones and exploring alternatives, Guide spurred Student 2’s shift toward conditional acceptance under strict evaluation protocols.  </li>
</ul>
<blockquote>
<p><strong>Kerra, you've raised an important distinction. How do you differentiate between 'needed' amputations and those driven by apotemnophilia? Consider the psychological distress involved and how it compares to other conditions where we modify healthy body parts.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students grappled with whether amputation can ethically treat apotemnophilia by weighing life-saving rationale against body identity distress.** Student 1 argued that removing healthy limbs could relieve profound suffering in BIID, while Student 2 initially rejected elective cuts but softened after discussing childhood-onset desires and positive post-surgery testimonials.  
- **Guide kept the conversation focused by insisting on clear definitions, challenging assumptions, and prompting ethical and procedural safeguards.** Through targeted questions about distinguishing necessary amputations from identity-driven ones and exploring alternatives, Guide spurred Student 2’s shift toward conditional acceptance under strict evaluation protocols.  


&gt; **Kerra, you&#39;ve raised an important distinction. How do you differentiate between &#39;needed&#39; amputations and those driven by apotemnophilia? Consider the psychological distress involved and how it compares to other conditions where we modify healthy body parts.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==1329257edf::student-dwfilmvkdq==1ac01fe0df::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Medical Paternalism
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556">
                                  <ul>
<li><strong>Students clashed over whether medical paternalism is justified only when a patient’s decision-making capacity is impaired, not merely to improve general welfare.</strong> Student 2 argued for overruling patient wishes in cases of mental instability or coercion—citing DNR scenarios—while Student 1 maintained that autonomy should prevail unless a psychological evaluation confirms compromised judgment.  </li>
<li><strong>Guide systematically guided the debate by requesting concrete examples and definitions—of being in the “right state of mind,” DNR conflicts, and mental health assessments.</strong> Its prompts kept students on track, pushed them to clarify their criteria for justified paternalism, and balanced the discussion between patient autonomy and medical responsibility.  </li>
<li><strong>Despite an initially polarized stance, both students converged on the idea of mandatory psychological evaluations before major interventions but acknowledged serious downsides like diagnostic errors and erosion of patient trust.</strong> Their rapid consensus reveals an interesting blind spot: they did not deeply engage with the practical or ethical challenges of implementing universal mental-health screenings.</li>
</ul>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556" class="form-control summary-markdown-editor">- **Students clashed over whether medical paternalism is justified only when a patient’s decision-making capacity is impaired, not merely to improve general welfare.** Student 2 argued for overruling patient wishes in cases of mental instability or coercion—citing DNR scenarios—while Student 1 maintained that autonomy should prevail unless a psychological evaluation confirms compromised judgment.  
- **Guide systematically guided the debate by requesting concrete examples and definitions—of being in the “right state of mind,” DNR conflicts, and mental health assessments.** Its prompts kept students on track, pushed them to clarify their criteria for justified paternalism, and balanced the discussion between patient autonomy and medical responsibility.  
- **Despite an initially polarized stance, both students converged on the idea of mandatory psychological evaluations before major interventions but acknowledged serious downsides like diagnostic errors and erosion of patient trust.** Their rapid consensus reveals an interesting blind spot: they did not deeply engage with the practical or ethical challenges of implementing universal mental-health screenings.</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==23bacef2dd::student-dwfilmvkdq==a8cfc07edd::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Patient Autonomy
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556">
                                  <ul>
<li><strong>Students debated patient autonomy in the context of misleading patients and the limits of medical paternalism.</strong> They weighed whether doctors should nudge patients or remain strictly neutral, discussing how cognitive deficits or historical mistrust might justify overriding full autonomy in select cases.</li>
<li><strong>Students argued over the need for clear, unbiased communication in medical settings.</strong> One side pushed for objective, comprehensive disclosure to maintain patient trust, while the other highlighted practical examples where simplifying information and contextual nuance might better serve patient outcomes.</li>
<li><strong>Guide pushed both sides to deepen their analysis with precise questions.</strong> By challenging assumptions on honesty, expertise, and historical bias, Guide spurred the discussion to consider the balance between medical guidance and respect for patient decisions.</li>
</ul>
<blockquote>
<p><strong>Student 1, you've highlighted the importance of trust. How can doctors rebuild trust in communities with historical reasons for skepticism, while still maintaining patient autonomy? Student 2, your experience is valuable. How would you balance the benefits of downplaying discomfort with a patient's right to fully informed consent?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556" class="form-control summary-markdown-editor">- **Students debated patient autonomy in the context of misleading patients and the limits of medical paternalism.** They weighed whether doctors should nudge patients or remain strictly neutral, discussing how cognitive deficits or historical mistrust might justify overriding full autonomy in select cases.
- **Students argued over the need for clear, unbiased communication in medical settings.** One side pushed for objective, comprehensive disclosure to maintain patient trust, while the other highlighted practical examples where simplifying information and contextual nuance might better serve patient outcomes.
- **Guide pushed both sides to deepen their analysis with precise questions.** By challenging assumptions on honesty, expertise, and historical bias, Guide spurred the discussion to consider the balance between medical guidance and respect for patient decisions.

&gt; **Student 1, you&#39;ve highlighted the importance of trust. How can doctors rebuild trust in communities with historical reasons for skepticism, while still maintaining patient autonomy? Student 2, your experience is valuable. How would you balance the benefits of downplaying discomfort with a patient&#39;s right to fully informed consent?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==3692c9d0df::student-dwfilmvkdq==8793533cdd::4c71986d1b::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556">
                                  <ul>
<li><strong>Students engaged in a deep ethical debate over whether amputation is a justifiable treatment for apotemnophilia.</strong> Student 1 argued for exhausting mental health interventions and preserving bodily integrity, while Student 2 emphasized patient autonomy and potential psychological benefits once psychiatric clearance is secured.</li>
<li><strong>Guide steered the conversation toward precise ethical definitions and trade-offs between physical and psychological harm.</strong> By probing criteria for medical necessity, long-term regret safeguards, and the balance of autonomy versus nonmaleficence, it compelled both students to articulate and refine their positions.</li>
</ul>
<blockquote>
<p><strong>Student 1, you emphasize treating the mental illness first. How would you respond to cases where psychological treatments have been exhausted without success? Student 2, you argue that denying the procedure could cause psychological harm. Can you elaborate on how amputation might address the underlying psychological distress of apotemnophilia? Let's explore the balance between physical and psychological well-being in this complex issue.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students engaged in a deep ethical debate over whether amputation is a justifiable treatment for apotemnophilia.** Student 1 argued for exhausting mental health interventions and preserving bodily integrity, while Student 2 emphasized patient autonomy and potential psychological benefits once psychiatric clearance is secured.
- **Guide steered the conversation toward precise ethical definitions and trade-offs between physical and psychological harm.** By probing criteria for medical necessity, long-term regret safeguards, and the balance of autonomy versus nonmaleficence, it compelled both students to articulate and refine their positions.


&gt; **Student 1, you emphasize treating the mental illness first. How would you respond to cases where psychological treatments have been exhausted without success? Student 2, you argue that denying the procedure could cause psychological harm. Can you elaborate on how amputation might address the underlying psychological distress of apotemnophilia? Let&#39;s explore the balance between physical and psychological well-being in this complex issue.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==7208e4c4df::student-dwfilmvkdq==988dab6ade::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Medical Paternalism
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556">
                                  <ul>
<li><strong>Students debated when medical paternalism is ethically justified.</strong> Student 1 argued that paternalism may work when patients lose decision-making capacity and emphasized the importance of having an advocate, while Student 2 countered with the danger of overriding informed patient consent and stressed the need for strict ethical guidelines.  </li>
<li><strong>The discussion evolved from clarifying the term “sufficiently high” gain to exploring concrete safeguards for patient welfare.</strong> Both students examined various scenarios—from unconscious patients to those with strong cultural or religious values—and debated the role of second opinions, ethics committees, and soft paternalism in shaping responsible care.  </li>
<li><strong>Guide played an active role by challenging assumptions and urging deeper ethical analysis.</strong> It repeatedly prompted the students to refine their definitions and consider broader factors like long-term quality of life, cultural diversity, and the balancing of individual autonomy with medical expertise.</li>
</ul>
<blockquote>
<p><strong>Student 2, great question. One area you haven't fully explored is the role of cultural differences in medical decision-making. How might cultural beliefs and practices impact the application of medical paternalism across different communities? Consider how this might affect doctor-patient relationships and the implementation of ethical guidelines.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556" class="form-control summary-markdown-editor">- **Students debated when medical paternalism is ethically justified.** Student 1 argued that paternalism may work when patients lose decision-making capacity and emphasized the importance of having an advocate, while Student 2 countered with the danger of overriding informed patient consent and stressed the need for strict ethical guidelines.  
- **The discussion evolved from clarifying the term “sufficiently high” gain to exploring concrete safeguards for patient welfare.** Both students examined various scenarios—from unconscious patients to those with strong cultural or religious values—and debated the role of second opinions, ethics committees, and soft paternalism in shaping responsible care.  
- **Guide played an active role by challenging assumptions and urging deeper ethical analysis.** It repeatedly prompted the students to refine their definitions and consider broader factors like long-term quality of life, cultural diversity, and the balancing of individual autonomy with medical expertise.

  
&gt; **Student 2, great question. One area you haven&#39;t fully explored is the role of cultural differences in medical decision-making. How might cultural beliefs and practices impact the application of medical paternalism across different communities? Consider how this might affect doctor-patient relationships and the implementation of ethical guidelines.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==612b4322df::student-z21hawwuy29t7abc1642dd::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Apotemnophilia
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556">
                                  <ul>
<li><strong>Students clashed over elective amputation as treatment for apotemnophilia, with Student 2 viewing it as relief from unbearable mental anguish and Student 1 warning of ethical dangers without exhausting mental-health care first.</strong> They debated patient autonomy versus the physician’s duty to do no harm, highlighting the need for robust psychiatric evaluation before any irreversible procedure.  </li>
<li><strong>Over time both converged on a case-by-case approach that prioritizes exhaustive non-surgical interventions and respects informed consent only when self-harm risk is immediate and severe.</strong> Student 2 moderated its initial eagerness by acknowledging the role of specialists, while Student 1 held firm on safeguarding against slippery-slope scenarios.  </li>
<li><strong>Guide drove deeper analysis by probing conflicts between autonomy and beneficence, questioning how to assess “conscious enough” consent, and inviting scrutiny of slippery-slope objections.</strong> Its interventions ensured students addressed both short-term self-harm risks and long-term societal implications of legitimizing body-integrity surgeries.  </li>
</ul>
<blockquote>
<p><strong>Student 2, how do you respond to Student 1’s emphasis on patient autonomy? Do you see any potential conflicts between respecting patient autonomy and the physician’s duty to do no harm? Consider also the unique nature of apotemnophilia – how might this condition complicate the typical doctor-patient relationship and decision-making process?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556" class="form-control summary-markdown-editor">- **Students clashed over elective amputation as treatment for apotemnophilia, with Student 2 viewing it as relief from unbearable mental anguish and Student 1 warning of ethical dangers without exhausting mental-health care first.** They debated patient autonomy versus the physician’s duty to do no harm, highlighting the need for robust psychiatric evaluation before any irreversible procedure.  
- **Over time both converged on a case-by-case approach that prioritizes exhaustive non-surgical interventions and respects informed consent only when self-harm risk is immediate and severe.** Student 2 moderated its initial eagerness by acknowledging the role of specialists, while Student 1 held firm on safeguarding against slippery-slope scenarios.  
- **Guide drove deeper analysis by probing conflicts between autonomy and beneficence, questioning how to assess “conscious enough” consent, and inviting scrutiny of slippery-slope objections.** Its interventions ensured students addressed both short-term self-harm risks and long-term societal implications of legitimizing body-integrity surgeries.  


&gt; **Student 2, how do you respond to Student 1’s emphasis on patient autonomy? Do you see any potential conflicts between respecting patient autonomy and the physician’s duty to do no harm? Consider also the unique nature of apotemnophilia – how might this condition complicate the typical doctor-patient relationship and decision-making process?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==209c3410dd::student-z21hawwuy29t344c4094df::28be27b370::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Medical Paternalism
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556">
                                  <ul>
<li>
<p><strong>Students debated the ethical merits of medical paternalism.</strong> Student 1 championed patient autonomy, insisting that doctors should only intervene when patients are incapable of rational decision-making, while Student 2 leaned toward doctors playing an active role in guiding patients, especially when family support is involved. Their discussion also examined the challenges posed by religious beliefs and the limits of medical intervention.</p>
</li>
<li>
<p><strong>Guide’s targeted questions pushed the debate into deeper ethical territory.</strong> Guide probed the students to explain how to balance patient autonomy with the need for intervention in extreme cases, asking them to consider when it is ethically justifiable to override a patient’s decision for their own good and for others.  </p>
</li>
</ul>
<blockquote>
<p><strong>Student 1, you've raised an important point about bodily autonomy. How do you reconcile this principle with cases where a patient's decision might lead to severe harm or death, even when they've been fully informed? Consider a scenario where a patient refuses a life-saving treatment due to unfounded fears. Does the doctor have any ethical obligation to intervene beyond just providing information?</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556" class="form-control summary-markdown-editor">- **Students debated the ethical merits of medical paternalism.** Student 1 championed patient autonomy, insisting that doctors should only intervene when patients are incapable of rational decision-making, while Student 2 leaned toward doctors playing an active role in guiding patients, especially when family support is involved. Their discussion also examined the challenges posed by religious beliefs and the limits of medical intervention.

- **Guide’s targeted questions pushed the debate into deeper ethical territory.** Guide probed the students to explain how to balance patient autonomy with the need for intervention in extreme cases, asking them to consider when it is ethically justifiable to override a patient’s decision for their own good and for others.  

&gt; **Student 1, you&#39;ve raised an important point about bodily autonomy. How do you reconcile this principle with cases where a patient&#39;s decision might lead to severe harm or death, even when they&#39;ve been fully informed? Consider a scenario where a patient refuses a life-saving treatment due to unfounded fears. Does the doctor have any ethical obligation to intervene beyond just providing information?**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-dwfilmvkdq==b47c4be4df::student-dwfilmvkdq==f0dad5d2dd::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
                  <div class="masonry-item">
                    <div class="card thread-card" id="thread-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556">
                      <div class="card-header d-flex justify-content-between align-items-center flex-nowrap">
                          <h6 class="mb-0 thread-heading" style="flex-shrink:1; min-width:0;">
                              
                                  Medical Paternalism
                              
                          </h6>
                          
                          
                      </div>
                      <div class="card-body">
                          
                              <div class="thread-summary markdown-content" id="summary-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556">
                                  <ul>
<li><strong>Students wrestled with tensions between patient autonomy and justified medical paternalism.</strong> Student 1 championed collaborative decision-making whenever the patient is capable, while Student 2 acknowledged autonomy but accepted paternalism under severe constraints like unconsciousness or emergency. They explored scenarios from life-threatening crises to early-stage dementia and discussed strategies such as easing cognitive barriers or consulting relatives.</li>
<li><strong>Guide propelled the conversation into nuanced territory by probing definitions and gray areas.</strong> It challenged students to specify what counts as incapacity, to elaborate on Ackerman’s four constraints, and to balance risk mitigation with respect for autonomy. Its targeted questions consistently steered the group from abstract positions toward concrete policy and practice implications.</li>
<li><strong>Despite initial disagreement, both students landed on a cautious middle ground emphasizing transparency and safeguards.</strong> They agreed emergencies and severe impairment justify paternalism but stressed the importance of maximizing patient involvement, consulting family members, and ensuring thorough research and peer review. Concerns about trust erosion and legal liabilities underscored their call for clear communication and multidisciplinary checks.</li>
</ul>
<blockquote>
<p><strong>Student 1, you've raised an important point about patient autonomy and shared decision-making. Can you think of any extreme scenarios where a doctor's paternalistic action might be justified, even if the patient is capable of making decisions? Consider cases where time is of the essence or where a patient's decision might have severe, irreversible consequences.</strong></p>
</blockquote>
                              </div>
                          
                          
                          <div class="status-message thread-status" id="status-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          <div class="spinner-border spinner-border-sm text-orange" role="status" id="spinner-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556" style="display: none;">
                              <span class="sr-only">Loading...</span>
                          </div>
                          
                          <!-- Edit Summary Modal Content -->
                          <div id="summary-editor-container-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556" class="summary-editor-container" style="display: none;">
                              <div class="alert alert-info">
                                  <i class="fas fa-info-circle mr-2"></i> Edit the summary in markdown format.
                              </div>
                              <textarea id="summary-markdown-editor-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556" class="form-control summary-markdown-editor">- **Students wrestled with tensions between patient autonomy and justified medical paternalism.** Student 1 championed collaborative decision-making whenever the patient is capable, while Student 2 acknowledged autonomy but accepted paternalism under severe constraints like unconsciousness or emergency. They explored scenarios from life-threatening crises to early-stage dementia and discussed strategies such as easing cognitive barriers or consulting relatives.
- **Guide propelled the conversation into nuanced territory by probing definitions and gray areas.** It challenged students to specify what counts as incapacity, to elaborate on Ackerman’s four constraints, and to balance risk mitigation with respect for autonomy. Its targeted questions consistently steered the group from abstract positions toward concrete policy and practice implications.
- **Despite initial disagreement, both students landed on a cautious middle ground emphasizing transparency and safeguards.** They agreed emergencies and severe impairment justify paternalism but stressed the importance of maximizing patient involvement, consulting family members, and ensuring thorough research and peer review. Concerns about trust erosion and legal liabilities underscored their call for clear communication and multidisciplinary checks.



&gt; **Student 1, you&#39;ve raised an important point about patient autonomy and shared decision-making. Can you think of any extreme scenarios where a doctor&#39;s paternalistic action might be justified, even if the patient is capable of making decisions? Consider cases where time is of the essence or where a patient&#39;s decision might have severe, irreversible consequences.**</textarea>
                              <div class="mt-3">
                                  <button class="btn btn-primary save-summary-btn" data-session-id="student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-save mr-1"></i> Save Changes
                                  </button>
                                  <button class="btn btn-secondary ml-2 cancel-summary-edit-btn" data-session-id="student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556">
                                      <i class="fas fa-times mr-1"></i> Cancel
                                  </button>
                                  <div class="spinner-border text-primary ml-2 summary-editor-spinner" role="status" id="summary-editor-spinner-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556" style="display: none;">
                                      <span class="sr-only">Saving...</span>
                                  </div>
                              </div>
                              <div class="status-message summary-editor-status" id="summary-editor-status-student-awnsb3vklmnvbq==1ec9a7b4df::student-dwfilmvkdq==ed832820df::5b9ce1e246::b774c6f556" style="display: none;"></div>
                          </div>
                      </div>
                    </div>
                  </div>
                
              </div>
            
          </div>
        </div>
      </div>
      
      <div style="clear:both; height:20px;"></div>
      
      <!-- Add Qualtrics Survey Data Card - if data exists -->
      
      <div class="row mb-4">
        <div class="col-12">
          <div class="py-4 mb-4">
            <h5 class="section-title">
              <div class="title-text"><i class="fas fa-chart-bar mr-1"></i> Post-Chat Survey Data</div>
            </h5>
            <div class="card-body pt-0">
              <div class="row">
                <div class="col-md-4 d-flex flex-column align-items-center justify-content-center py-3">
                  <h3>29</h3>
                  <p class="text-muted">Total Survey Responses</p>
                </div>
                <div class="col-md-4 d-flex flex-column align-items-center justify-content-center py-3">
                  <h3>15</h3>
                  <p class="text-muted">Threads With Surveys</p>
                </div>
                <div class="col-md-4 d-flex flex-column align-items-center justify-content-center py-3">
                  <h3>88.2%</h3>
                  <p class="text-muted">Response Rate</p>
                </div>
              </div>
              <div class="d-flex justify-content-between align-items-center text-muted small mb-0" style="gap: 1rem;">
                <span class="ml-auto text-right" style="flex:1; text-align:right;">Last updated: 2025-05-06 22:34:05.961064</span>
                
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Separate row for survey histogram charts floating on background -->
      <div class="row mb-4">
        <div class="col-12">
          
            <!-- Overall Rating and Guide Feedback -->
            <div class="row">
              
              <div class="col-md-6 mb-4">
                <div class="card h-100 thread-card">
                  <div class="card-body p-0">
                    
                    
<div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:0; height:100%;">
    <div style="background:#18182b; padding:20px 25px 10px 25px; border-bottom:1px solid #23233a;">
        <div style="font-size:1.1rem; font-weight:500; line-height:1.3; height:2.6em; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">How was your chat?</div>
    </div>
    <div style="padding:25px;">
        <div style="position:relative; width:100%;">

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">🔥 Awesome</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">14 (48.3%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:48.275862068965516%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">👍 Good</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">13 (44.8%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:44.827586206896555%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">😐 It's OK</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">1 (3.4%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:3.4482758620689653%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">👎 Not a fan</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">💩 Hated it</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">1 (3.4%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:3.4482758620689653%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:10px; letter-spacing:0.01em;">mean = 1.66 <span style="opacity:0.7;">(95% confidence interval: 1.33–1.98)</span></div>
    </div>
</div>
                  </div>
                </div>
              </div>
              
              
              
              <div class="col-md-6 mb-4">
                <div class="card h-100 thread-card">
                  <div class="card-body p-0">
                    
                    
                      
<div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:0; height:100%;">
    <div style="background:#18182b; padding:20px 25px 10px 25px; border-bottom:1px solid #23233a;">
        <div style="font-size:1.1rem; font-weight:500; line-height:1.3; height:2.6em; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">Guide contributed the right amount</div>
    </div>
    <div style="padding:25px;">
        <div style="position:relative; width:100%;">

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">24 (82.8%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:82.75862068965517%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Neutral</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">5 (17.2%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:17.24137931034483%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:10px; letter-spacing:0.01em;">mean = 0.83 <span style="opacity:0.7;">(95% confidence interval: 0.68–0.97)</span></div>
    </div>
</div>
                    
                  </div>
                </div>
              </div>
              
            </div>
            
            <div style="height: 2rem;"></div>
            <div class="row">
              
              
                
              
                
              
                
              
                
              
                
                  <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 thread-card">
                      <div class="card-body p-0">
                        
                        
<div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:0; height:100%;">
    <div style="background:#18182b; padding:20px 25px 10px 25px; border-bottom:1px solid #23233a;">
        <div style="font-size:1.1rem; font-weight:500; line-height:1.3; height:2.6em; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">I felt comfortable sharing my honest opinions with my partner</div>
    </div>
    <div style="padding:25px;">
        <div style="position:relative; width:100%;">

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">8 (53.3%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:53.333333333333336%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">7 (46.7%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:46.666666666666664%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Neutral</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:10px; letter-spacing:0.01em;">mean = 1.53 <span style="opacity:0.7;">(95% confidence interval: 1.25–1.82)</span></div>
    </div>
</div>
                      </div>
                    </div>
                  </div>
                
              
                
              
                
                  <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 thread-card">
                      <div class="card-body p-0">
                        
                        
<div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:0; height:100%;">
    <div style="background:#18182b; padding:20px 25px 10px 25px; border-bottom:1px solid #23233a;">
        <div style="font-size:1.1rem; font-weight:500; line-height:1.3; height:2.6em; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">I was not offended by my partner's perspective</div>
    </div>
    <div style="padding:25px;">
        <div style="position:relative; width:100%;">

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">13 (86.7%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:86.66666666666667%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">1 (6.7%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:6.666666666666667%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Neutral</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">1 (6.7%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:6.666666666666667%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:10px; letter-spacing:0.01em;">mean = 1.80 <span style="opacity:0.7;">(95% confidence interval: 1.49–2.11)</span></div>
    </div>
</div>
                      </div>
                    </div>
                  </div>
                
              
                
                  <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 thread-card">
                      <div class="card-body p-0">
                        
                        
<div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:0; height:100%;">
    <div style="background:#18182b; padding:20px 25px 10px 25px; border-bottom:1px solid #23233a;">
        <div style="font-size:1.1rem; font-weight:500; line-height:1.3; height:2.6em; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">It was valuable to chat with a student who did not share my perspective</div>
    </div>
    <div style="padding:25px;">
        <div style="position:relative; width:100%;">

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">7 (43.8%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:43.75%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">7 (43.8%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:43.75%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Neutral</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">2 (12.5%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:12.5%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">0 (0.0%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:0.0%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:10px; letter-spacing:0.01em;">mean = 1.31 <span style="opacity:0.7;">(95% confidence interval: 0.94–1.69)</span></div>
    </div>
</div>
                      </div>
                    </div>
                  </div>
                
              
                
              
                
                  <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 thread-card">
                      <div class="card-body p-0">
                        
                        
<div style="font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif; background:#1e1e2d; color:#e4e6eb; border-radius:10px; overflow:hidden; padding:0; height:100%;">
    <div style="background:#18182b; padding:20px 25px 10px 25px; border-bottom:1px solid #23233a;">
        <div style="font-size:1.1rem; font-weight:500; line-height:1.3; height:2.6em; max-height:2.6em; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">It would be good if more students and classes used Sway</div>
    </div>
    <div style="padding:25px;">
        <div style="position:relative; width:100%;">

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">9 (47.4%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:47.368421052631575%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Agree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">5 (26.3%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:26.31578947368421%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Neutral</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">2 (10.5%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:10.526315789473683%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">1 (5.3%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:5.263157894736842%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>

            <div style="margin-bottom:12px;">
                <div style="display:flex; justify-content:space-between; margin-bottom:4px;">
                    <span style="font-size:0.9rem; color:#e4e6eb;">Strongly disagree</span>
                    <span style="font-size:0.9rem; color:#a9adc1;">2 (10.5%)</span>
                </div>
                <div style="height:20px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden;">
                    <div style="height:100%; width:10.526315789473683%; background-color:#8a8aff; border-radius:4px;"></div>
                </div>
            </div>
        </div>
        <div style="text-align:center; color:#b0b3c7; font-size:13px; margin-top:10px; letter-spacing:0.01em;">mean = 0.95 <span style="opacity:0.7;">(95% confidence interval: 0.30–1.60)</span></div>
    </div>
</div>
                      </div>
                    </div>
                  </div>
                
              
            </div>
            
            <!-- Opinion Changes Section -->
            
          
        </div>
      </div>
      
      <!-- End Qualtrics Survey Data Section -->
    </div>
  </div>
  
<!-- Modal containers will be dynamically injected here by JS if needed -->
<div id="modal-container"></div> 
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
  

<!-- =====================
     Core Utilities
     ===================== -->
<script>
  // Debug logging utility
  function debug_log(message, level, details = null) {
    if (details) {
      console.log(`DEBUG[${level}]:`, message, details);
    } else {
      console.log(`DEBUG[${level}]:`, message);
    }
  }

  // Convert UTC timestamps to local timezone
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('[data-utc-time]').forEach(function(element) {
      const utcTime = element.getAttribute('data-utc-time');
      try {
        const localDate = new Date(utcTime);
        if (!isNaN(localDate)) {
          const options = {
            year: 'numeric',
            month: 'short',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
          };
          const localTimeStr = localDate.toLocaleString(undefined, options);
          const localTimeElement = element.nextElementSibling;
          if (localTimeElement && localTimeElement.classList.contains('local-time')) {
            localTimeElement.textContent = localTimeStr;
            element.style.display = 'none';
            localTimeElement.style.display = 'inline';
          }
        }
      } catch (e) {
        console.error('Error converting time:', e);
      }
    });
  });
</script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- =====================
     Theme Toggle
     ===================== -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const themeToggle = document.getElementById('theme-toggle-input'); // Fixed id to match the input in _header.html
    if (!themeToggle) return;
    // Determine initial theme from localStorage or template variable
    let initialTheme = localStorage.getItem('theme');
    if (!initialTheme) {
      initialTheme = 'dark-mode' === 'light-mode' ? 'light' : 'dark';
    }
    // Set initial toggle state and class
    themeToggle.checked = initialTheme === 'light';
    document.documentElement.className = initialTheme === 'light' ? 'light-mode' : 'dark-mode';
    // Add event listener for theme toggle
    themeToggle.addEventListener('change', function() {
      if (this.checked) {
        document.documentElement.classList.remove('dark-mode');
        document.documentElement.classList.add('light-mode');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.remove('light-mode');
        document.documentElement.classList.add('dark-mode');
        localStorage.setItem('theme', 'dark');
      }
    });
  });
</script>

<!-- =====================
     Summary/Report Generation & Polling
     ===================== -->
<script>
  let pollingInterval = null;
  let cancelRequested = false;
  document.addEventListener('DOMContentLoaded', function() {
    const generateBtn = document.getElementById('generate-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const reportBtn = document.getElementById('report-btn');
    let hasSavedSummaries = "true" === "true";
    
    // Check directly if there are any thread summaries actually present on the page
    const allThreadSummaries = document.querySelectorAll('.thread-summary.markdown-content');
    const hasVisibleSummaries = Array.from(allThreadSummaries).some(el => 
      el.innerHTML.trim() !== '' && el.style.display !== 'none'
    );
    
    // If we have visible summaries on the page, allow generating the report regardless of server-side flag
    if (hasVisibleSummaries) {
      hasSavedSummaries = true;
      debug_log("Enabling report button because visible summaries were found on page", 1);
    }
    
    if (reportBtn && hasSavedSummaries) {
      reportBtn.disabled = false;
      debug_log("Enabling report button because saved summaries exist", 1);
    }
    // Check if any thread is currently in 'generating' status
    const hasGeneratingThreads = Array.from(document.querySelectorAll('.thread-status'))
      .some(el => el.textContent === 'Generating summary...');
    if (hasGeneratingThreads) {
      startPolling();
      if (generateBtn) generateBtn.style.display = 'none';
      if (cancelBtn) cancelBtn.style.display = 'inline-block';
    }
    // Generate summaries
    if (generateBtn) {
      generateBtn.addEventListener('click', function() {
        document.querySelectorAll('.thread-status').forEach(status => {
          status.textContent = 'Queued for generation...';
          status.style.display = 'block';
          status.className = 'thread-status text-info';
        });
        generateBtn.style.display = 'none';
        if (cancelBtn) cancelBtn.style.display = 'inline-block';
        fetch('/assignment/b774c6f556/generate_summaries', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        })
        .then(response => {
          if (response.ok) {
            debug_log("Summaries queued successfully", 1);
            startPolling();
            if (reportBtn) reportBtn.disabled = false;
          } else {
            debug_log("Error queueing summaries", 1);
          }
        })
        .catch(error => debug_log("Network error:", error, 1));
      });
      if (cancelBtn) {
        cancelBtn.addEventListener('click', function() {
          cancelRequested = true;
          fetch('/assignment/b774c6f556/cancel_generation', { method: 'POST' })
            .then(response => {
              if (response.ok) {
                stopPolling();
                document.querySelectorAll('.thread-status').forEach(status => {
                  if (status.textContent === 'Queued for generation...') status.style.display = 'none';
                });
                document.querySelectorAll('.spinner-border').forEach(spinner => spinner.style.display = 'none');
                generateBtn.style.display = 'inline-block';
                cancelBtn.style.display = 'none';
              }
            });
        });
      }
    }
    // Report button
    if (reportBtn) {
      // Show/hide advanced thinking controls based on model selection
      const modelToggleGroup = document.getElementById('report-model-toggle-group');
      const advancedThinkingControls = document.getElementById('advanced-thinking-controls');
      function updateThinkingControlsVisibility() {
        const checked = modelToggleGroup.querySelector('input[type=radio]:checked');
        if (checked && checked.value === 'anthropic') {
          advancedThinkingControls.style.display = 'flex';
        } else {
          advancedThinkingControls.style.display = 'none';
        }
      }
      if (modelToggleGroup && advancedThinkingControls) {
        modelToggleGroup.addEventListener('change', updateThinkingControlsVisibility);
        updateThinkingControlsVisibility();
      }
      reportBtn.addEventListener('click', function() {
        const reportSpinner = document.getElementById('report-spinner');
        if (reportSpinner) reportSpinner.style.display = 'inline-block';
        reportBtn.disabled = true;
        const noReportMsg = document.getElementById('no-report-msg');
        if (noReportMsg) {
          noReportMsg.textContent = 'Generating instructor report...';
          noReportMsg.className = 'text-info mb-0';
        }
        // Collect all visible summaries from the UI
        const summaries = {};
        document.querySelectorAll('.thread-card').forEach(card => {
          const threadId = card.id.replace('thread-', '');
          const summaryEl = card.querySelector('.thread-summary');
          if (summaryEl && summaryEl.innerHTML.trim() !== '' && summaryEl.style.display !== 'none') {
            // Try to get the raw markdown if available
            let summaryContent = '';
            const editorEl = card.querySelector('.summary-markdown-editor');
            if (editorEl && editorEl.value.trim() !== '') {
              summaryContent = editorEl.value.trim();
            } else {
              // Otherwise use the HTML content
              summaryContent = summaryEl.innerHTML;
            }
            summaries[threadId] = {
              thread_id: threadId,
              assignment_id: 'b774c6f556',
              summary: summaryContent,
              content: summaryContent,
              status: 'completed'
            };
          }
        });
        debug_log(`Collected ${Object.keys(summaries).length} visible summaries from UI`, 1);
        // Get selected model provider
        let modelProvider = 'openai';
        const checked = document.querySelector('#report-model-toggle-group input[type=radio]:checked');
        if (checked) modelProvider = checked.value;
        // Get advanced thinking mode and budget if Anthropic
        let enableThinking = false;
        let thinkingBudgetTokens = 4096;
        if (modelProvider === 'anthropic') {
          const enableThinkingCheckbox = document.getElementById('enable-thinking-checkbox');
          const thinkingBudgetInput = document.getElementById('thinking-budget-input');
          if (enableThinkingCheckbox && enableThinkingCheckbox.checked) {
            enableThinking = true;
          }
          if (thinkingBudgetInput && thinkingBudgetInput.value) {
            thinkingBudgetTokens = parseInt(thinkingBudgetInput.value) || 4096;
          }
        }
        fetch('/assignment/b774c6f556/generate_report', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            summaries: summaries,
            model_provider: modelProvider,
            enable_thinking: enableThinking,
            thinking_budget_tokens: thinkingBudgetTokens
          })
        })
        .then(response => response.json())
        .then(data => {
          debug_log("Report generation initiated:", data, 1);
          checkReportStatus();
        })
        .catch(error => {
          debug_log("Error generating report:", error, 1);
          reportBtn.disabled = false;
          if (reportSpinner) reportSpinner.style.display = 'none';
          if (noReportMsg) {
            noReportMsg.textContent = 'Error generating report. Please try again.';
            noReportMsg.className = 'text-danger mb-0';
          }
        });
      });
    }
    // Refresh data
    const refreshDataBtn = document.getElementById('refresh-data-btn');
    if (refreshDataBtn) {
      refreshDataBtn.addEventListener('click', function() {
        const refreshSpinner = document.getElementById('refresh-spinner');
        if (refreshSpinner) refreshSpinner.style.display = 'inline-block';
        refreshDataBtn.disabled = true;
        fetch('/assignment/b774c6f556/refresh_data', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        })
        .then(response => response.json())
        .then(data => {
          debug_log("Data refresh initiated:", data, 1);
          window.location.reload();
        })
        .catch(error => {
          debug_log("Error refreshing data:", error, 1);
          if (refreshSpinner) refreshSpinner.style.display = 'none';
          refreshDataBtn.disabled = false;
          alert('Error refreshing data. Please try again.');
        });
      });
    }
    // Regenerate title
    const regenerateTitleBtn = document.getElementById('regenerate-title-btn');
    if (regenerateTitleBtn) {
      regenerateTitleBtn.addEventListener('click', function() {
        regenerateTitleBtn.disabled = true;
        const icon = regenerateTitleBtn.querySelector('i');
        const originalIcon = icon.className;
        icon.className = 'fas fa-spinner fa-spin';
        fetch('/assignment/b774c6f556/regenerate_title', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            const titleEl = document.querySelector('.generated-title');
            if (titleEl) titleEl.textContent = data.title;
            console.log("Title regenerated:", data.title);
          } else {
            console.error("Error regenerating title:", data.message);
            alert("Error regenerating title: " + data.message);
          }
          regenerateTitleBtn.disabled = false;
          icon.className = originalIcon;
        })
        .catch(error => {
          console.error("Error:", error);
          alert("Error regenerating title. Please try again.");
          regenerateTitleBtn.disabled = false;
          icon.className = originalIcon;
        });
      });
    }
    
    // Final check to ensure report button is enabled if summaries exist
    setTimeout(function() {
      const reportBtn = document.getElementById('report-btn');
      if (reportBtn && reportBtn.disabled) {
        const visibleSummaries = document.querySelectorAll('.thread-summary.markdown-content');
        const hasContent = Array.from(visibleSummaries).some(el => 
          el.innerHTML.trim() !== '' && el.style.display !== 'none'
        );
        
        if (hasContent) {
          reportBtn.disabled = false;
          debug_log("Enabling report button in final check - summaries exist", 1);
        }
      }
    }, 500); // Short delay to ensure all content is processed
  });
  function startPolling() {
    if (pollingInterval) clearInterval(pollingInterval);
    pollingInterval = setInterval(checkSummaryStatus, 2000);
    checkSummaryStatus();
  }
  function stopPolling() {
    if (pollingInterval) {
      clearInterval(pollingInterval);
      pollingInterval = null;
    }
  }
  function checkSummaryStatus() {
    fetch('/assignment/b774c6f556/summary_status')
      .then(response => response.json())
      .then(data => {
        let activeGeneration = false;
        Object.entries(data).forEach(([sessionId, threadInfo]) => {
          const statusEl = document.getElementById(`status-${sessionId}`);
          const summaryEl = document.getElementById(`summary-${sessionId}`);
          const spinnerEl = document.getElementById(`spinner-${sessionId}`);
          if (threadInfo.status === 'generating') {
            activeGeneration = true;
            if (statusEl) {
              statusEl.textContent = 'Generating summary...';
              statusEl.style.display = 'block';
              statusEl.className = 'thread-status text-warning';
            }
            if (spinnerEl) spinnerEl.style.display = 'inline-block';
          } else if (threadInfo.status === 'completed') {
            if (statusEl) statusEl.style.display = 'none';
            if (spinnerEl) spinnerEl.style.display = 'none';
            if (summaryEl && threadInfo.render_html) {
              summaryEl.innerHTML = threadInfo.render_html;
              summaryEl.style.display = 'block';
              // Update the markdown textarea value for this thread
              var textarea = document.getElementById(`summary-markdown-editor-${sessionId}`);
              if (textarea) {
                // If threadInfo has markdown, use it; otherwise, fallback to extracting from HTML
                if (threadInfo.markdown) {
                  textarea.value = threadInfo.markdown;
                } else if (threadInfo.render_html) {
                  // Optionally, convert HTML back to markdown if needed (or leave blank)
                  textarea.value = '';
                }
                // If CodeMirror is open for this thread, update its value too
                if (window.summaryEditors && window.summaryEditors[sessionId]) {
                  window.summaryEditors[sessionId].setValue(textarea.value);
                  window.summaryEditors[sessionId].refresh();
                }
              }
              // If a summary was successfully displayed, enable the report button
              const reportBtn = document.getElementById('report-btn');
              if (reportBtn) {
                reportBtn.disabled = false;
                debug_log("Enabling report button because a summary was loaded", 1);
              }
            }
          } else if (threadInfo.status === 'queued') {
            activeGeneration = true;
            if (statusEl) {
              statusEl.textContent = 'Queued for generation...';
              statusEl.style.display = 'block';
              statusEl.className = 'thread-status text-info';
            }
            if (spinnerEl) spinnerEl.style.display = 'none';
          } else if (threadInfo.status === 'error') {
            if (statusEl) {
              statusEl.textContent = 'Error generating summary';
              statusEl.style.display = 'block';
              statusEl.className = 'thread-status text-danger';
            }
            if (spinnerEl) spinnerEl.style.display = 'none';
          } else if (threadInfo.status === 'skipped') {
            if (statusEl) {
              statusEl.textContent = threadInfo.message || 'Skipped due to insufficient messages';
              statusEl.style.display = 'block';
              statusEl.className = 'thread-status text-warning';
            }
            if (spinnerEl) spinnerEl.style.display = 'none';
          }
        });
        if (!activeGeneration) {
          stopPolling();
          const generateBtn = document.getElementById('generate-btn');
          const cancelBtn = document.getElementById('cancel-btn');
          if (generateBtn) generateBtn.style.display = 'inline-block';
          if (cancelBtn) cancelBtn.style.display = 'none';
          const reportBtn = document.getElementById('report-btn');
          if (reportBtn) reportBtn.disabled = false;
        }
      })
      .catch(error => debug_log('Error checking summary status:', error, 1));
  }
  function checkReportStatus() {
    fetch('/assignment/b774c6f556/report_status')
      .then(response => response.json())
      .then(data => {
        const reportBtn = document.getElementById('report-btn');
        const reportSpinner = document.getElementById('report-spinner');
        const noReportMsg = document.getElementById('no-report-msg');
        const reportSection = document.getElementById('report-section');
        
        debug_log("Report status update:", data, 1);
        
        if (data.status === 'completed') {
          // Report generation completed
          if (reportSpinner) reportSpinner.style.display = 'none';
          if (reportBtn) {
            reportBtn.disabled = false;
            reportBtn.textContent = 'Regenerate report';
          }
          
          // Only update the UI if we have content
          if (data.content && reportSection) {
            const reportContent = document.createElement('div');
            reportContent.id = 'report-content';
            reportContent.className = 'markdown-content';
            const styleTag = document.createElement('style');
            styleTag.textContent = `#report-content ul ul {margin-top:0.5em;margin-bottom:0.5em;padding-left:2em;}#report-content li > ul {margin-left:1em;}`;
            reportContent.appendChild(styleTag);
            
            // Check if render_html is available first, otherwise use content
            if (data.render_html) {
              reportContent.innerHTML += data.render_html;
            } else {
              reportContent.innerHTML += data.content;
            }
            
            const generatedText = document.createElement('div');
            generatedText.className = 'text-muted mt-2 d-flex justify-content-end align-items-center';
            
            // Create formatted date display
            const formattedDate = new Date(data.generated_at).toLocaleDateString('en-US', {
              month: 'short', 
              day: 'numeric', 
              year: 'numeric',
              hour: 'numeric',
              minute: '2-digit',
              hour12: true
            });
            
            generatedText.innerHTML = `
              <span class="text-right" style="flex:1; text-align:right;">Generated on: ${formattedDate}</span>
              ${!exportMode ? `
                <button type="button" class="btn btn-link btn-sm text-muted p-0 ml-2" id="edit-report-btn" title="Edit report" style="vertical-align: baseline;">
                  <i class="fas fa-pencil-alt"></i>
                </button>
              ` : ''}
            `;
            
            // Clear existing content and append new content
            reportSection.innerHTML = '';
            reportSection.appendChild(reportContent);
            reportSection.appendChild(generatedText);
            
            // Convert UTC timestamps to local
            const utcTimeElements = reportSection.querySelectorAll('[data-utc-time]');
            utcTimeElements.forEach(function(element) {
              const utcTime = element.getAttribute('data-utc-time');
              try {
                const localDate = new Date(utcTime);
                if (!isNaN(localDate)) {
                  const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true };
                  const localTimeStr = localDate.toLocaleString(undefined, options);
                  const localTimeElement = element.nextElementSibling;
                  if (localTimeElement && localTimeElement.classList.contains('local-time')) {
                    localTimeElement.textContent = localTimeStr;
                    element.style.display = 'none';
                    localTimeElement.style.display = 'inline';
                  }
                }
              } catch (e) { console.error('Error converting time:', e); }
            });
            
            debug_log("Updated report UI with new content", 1);
          } else {
            debug_log("Report completed but no content received", 2);
          }
        } else if (data.status === 'generating' || data.status === 'running') {
          // Report is still being generated
          if (noReportMsg) {
            noReportMsg.textContent = 'Generating instructor report...';
            noReportMsg.className = 'text-info mb-0';
          }
          
          // Show elapsed time if available
          if (data.elapsed_seconds) {
            const elapsed = Math.round(data.elapsed_seconds);
            if (noReportMsg) {
              noReportMsg.textContent = `Generating instructor report... (${elapsed}s)`;
            }
          }
          
          // Continue polling
          setTimeout(checkReportStatus, 2000);
        } else if (data.status === 'error') {
          // Error generating report
          if (reportSpinner) reportSpinner.style.display = 'none';
          if (reportBtn) reportBtn.disabled = false;
          if (noReportMsg) {
            noReportMsg.textContent = `Error generating report: ${data.error || 'Unknown error'}`;
            noReportMsg.className = 'text-danger mb-0';
          }
        } else {
          // Unknown or not_started status
          if (reportSpinner) reportSpinner.style.display = 'none';
          if (reportBtn) reportBtn.disabled = false;
          if (data.report_exists && reportSection) {
            // If report exists but no status, try refreshing the page after a timeout
            debug_log("Report exists but status not provided - will try to reload content", 2);
            setTimeout(checkReportStatus, 2000);
          }
        }
      })
      .catch(error => {
        debug_log("Error checking report status:", error, 2);
        const reportSpinner = document.getElementById('report-spinner');
        const reportBtn = document.getElementById('report-btn');
        const noReportMsg = document.getElementById('no-report-msg');
        if (reportSpinner) reportSpinner.style.display = 'none';
        if (reportBtn) reportBtn.disabled = false;
        if (noReportMsg) {
          noReportMsg.textContent = 'Error checking report status. Please try again.';
          noReportMsg.className = 'text-danger mb-0';
        }
      });
  }
</script>

<!-- =====================
     CodeMirror for Editing
     ===================== -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/markdown/markdown.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/theme/material-darker.min.css">
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Report editing
    const editReportBtn = document.getElementById('edit-report-btn');
    const reportContent = document.getElementById('report-content');
    const reportEditorContainer = document.getElementById('report-editor-container');
    const saveReportBtn = document.getElementById('save-report-btn');
    const cancelReportEditBtn = document.getElementById('cancel-report-edit-btn');
    const editorSpinner = document.getElementById('editor-spinner');
    const statusMessage = document.getElementById('editor-status-message');
    let reportEditor;
    const reportMarkdownEditor = document.getElementById('report-markdown-editor');
    if (reportMarkdownEditor) {
      reportEditor = CodeMirror.fromTextArea(reportMarkdownEditor, {
        lineNumbers: true,
        theme: 'material-darker',
        mode: 'markdown',
        lineWrapping: true
      });
    }
    if (editReportBtn) {
      editReportBtn.addEventListener('click', function() {
        reportContent.style.display = 'none';
        reportEditorContainer.style.display = 'block';
        if (reportEditor) reportEditor.refresh();
      });
    }
    if (cancelReportEditBtn) {
      cancelReportEditBtn.addEventListener('click', function() {
        reportContent.style.display = 'block';
        reportEditorContainer.style.display = 'none';
        statusMessage.style.display = 'none';
      });
    }
    if (saveReportBtn) {
      saveReportBtn.addEventListener('click', function() {
        const markdown = reportEditor.getValue();
        if (!markdown.trim()) {
          showEditorStatus('Report content cannot be empty', 'error');
          return;
        }
        editorSpinner.style.display = 'inline-block';
        fetch('/assignment/b774c6f556/edit_report', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ markdown: markdown })
        })
        .then(response => response.json())
        .then(data => {
          editorSpinner.style.display = 'none';
          if (data.success) {
            reportContent.innerHTML = data.content;
            showEditorStatus(data.message, 'success');
            setTimeout(() => {
              reportContent.style.display = 'block';
              reportEditorContainer.style.display = 'none';
              statusMessage.style.display = 'none';
            }, 1500);
          } else {
            showEditorStatus(data.message, 'error');
          }
        })
        .catch(error => {
          editorSpinner.style.display = 'none';
          showEditorStatus('Error saving report: ' + error, 'error');
        });
      });
    }
    function showEditorStatus(message, type) {
      statusMessage.textContent = message;
      statusMessage.className = `status-message ${type}`;
      statusMessage.style.display = 'block';
      if (type === 'success') {
        setTimeout(() => { statusMessage.style.display = 'none'; }, 3000);
      }
    }
  });
</script>

<!-- =====================
     Summary Editing (CodeMirror)
     ===================== -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const editSummaryBtns = document.querySelectorAll('.edit-summary-btn');
    const regenerateSummaryBtns = document.querySelectorAll('.regenerate-summary-btn');
    const summaryEditors = {};
    editSummaryBtns.forEach(btn => {
      const sessionId = btn.getAttribute('data-session-id');
      const summaryElement = document.getElementById(`summary-${sessionId}`);
      const editorContainer = document.getElementById(`summary-editor-container-${sessionId}`);
      btn.addEventListener('click', function() {
        summaryElement.style.display = 'none';
        editorContainer.style.display = 'block';
        if (!summaryEditors[sessionId]) {
          const textarea = document.getElementById(`summary-markdown-editor-${sessionId}`);
          let markdownContent = textarea.value;
          if (!markdownContent) {
            markdownContent = summaryElement.innerHTML.replace(/<button.*?<\/button>/g, '');
          }
          summaryEditors[sessionId] = CodeMirror.fromTextArea(textarea, {
            lineNumbers: true,
            theme: 'material-darker',
            mode: 'markdown',
            lineWrapping: true
          });
          summaryEditors[sessionId].setValue(markdownContent);
          summaryEditors[sessionId].refresh();
        } else {
          summaryEditors[sessionId].refresh();
        }
      });
      const cancelBtn = document.querySelector(`.cancel-summary-edit-btn[data-session-id="${sessionId}"]`);
      if (cancelBtn) {
        cancelBtn.addEventListener('click', function() {
          summaryElement.style.display = 'block';
          editorContainer.style.display = 'none';
          document.getElementById(`summary-editor-status-${sessionId}`).style.display = 'none';
        });
      }
      const saveBtn = document.querySelector(`.save-summary-btn[data-session-id="${sessionId}"]`);
      if (saveBtn) {
        saveBtn.addEventListener('click', function() {
          const markdown = summaryEditors[sessionId].getValue();
          if (!markdown.trim()) {
            showSummaryStatus(sessionId, 'Summary content cannot be empty', 'error');
            return;
          }
          const spinner = document.getElementById(`summary-editor-spinner-${sessionId}`);
          spinner.style.display = 'inline-block';
          fetch('/assignment/b774c6f556/edit_summary', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ session_id: sessionId, markdown: markdown })
          })
          .then(response => response.json())
          .then(data => {
            spinner.style.display = 'none';
            if (data.success) {
              summaryElement.innerHTML = data.render_html || data.content;
              summaryElement.style.display = 'block';
              // Update the markdown textarea value
              var textarea = document.getElementById(`summary-markdown-editor-${sessionId}`);
              if (textarea) {
                textarea.value = markdown;
                if (window.summaryEditors && window.summaryEditors[sessionId]) {
                  window.summaryEditors[sessionId].setValue(markdown);
                  window.summaryEditors[sessionId].refresh();
                }
              }
              showSummaryStatus(sessionId, data.message, 'success');
              setTimeout(() => {
                editorContainer.style.display = 'none';
                document.getElementById(`summary-editor-status-${sessionId}`).style.display = 'none';
                attachButtonListeners(sessionId);
              }, 1500);
            } else {
              showSummaryStatus(sessionId, data.message || 'Error saving summary', 'error');
            }
          })
          .catch(error => {
            spinner.style.display = 'none';
            showSummaryStatus(sessionId, 'Error saving summary: ' + error, 'error');
          });
        });
      }
    });
    regenerateSummaryBtns.forEach(btn => {
      const sessionId = btn.getAttribute('data-session-id');
      const summaryElement = document.getElementById(`summary-${sessionId}`);
      btn.addEventListener('click', function() {
        // Removed confirmation dialog for immediate regeneration
        const statusElement = document.getElementById(`status-${sessionId}`);
        const spinnerElement = document.getElementById(`spinner-${sessionId}`);
        if (statusElement && spinnerElement) {
          statusElement.textContent = 'Regenerating summary...';
          statusElement.className = 'status-message thread-status text-info';
          statusElement.style.display = 'block';
          spinnerElement.style.display = 'inline-block';
          summaryElement.style.opacity = '0.5';
          fetch('/assignment/b774c6f556/regenerate_summary', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ session_id: sessionId })
          })
          .then(response => response.json())
          .then(data => {
            spinnerElement.style.display = 'none';
            if (data.success) {
              summaryElement.innerHTML = data.content;
              summaryElement.style.opacity = '1';
              statusElement.textContent = data.message;
              statusElement.className = 'status-message thread-status success';
              attachButtonListeners(sessionId);
              setTimeout(() => { statusElement.style.display = 'none'; }, 3000);
            } else {
              summaryElement.style.opacity = '1';
              statusElement.textContent = data.message || 'Error regenerating summary';
              statusElement.className = 'status-message thread-status error';
              setTimeout(() => { statusElement.style.display = 'none'; }, 5000);
            }
          })
          .catch(error => {
            spinnerElement.style.display = 'none';
            summaryElement.style.opacity = '1';
            statusElement.textContent = 'Error regenerating summary: ' + error;
            statusElement.className = 'status-message thread-status error';
            setTimeout(() => { statusElement.style.display = 'none'; }, 5000);
          });
        }
      });
    });
    function attachButtonListeners(sessionId) {
      const newEditBtn = document.querySelector(`.edit-summary-btn[data-session-id="${sessionId}"]`);
      const newRegenerateBtn = document.querySelector(`.regenerate-summary-btn[data-session-id="${sessionId}"]`);
      if (newEditBtn) {
        const summaryElement = document.getElementById(`summary-${sessionId}`);
        const editorContainer = document.getElementById(`summary-editor-container-${sessionId}`);
        newEditBtn.addEventListener('click', function() {
          summaryElement.style.display = 'none';
          editorContainer.style.display = 'block';
          if (!summaryEditors[sessionId]) {
            const textarea = document.getElementById(`summary-markdown-editor-${sessionId}`);
            let markdownContent = textarea.value;
            if (!markdownContent) {
              markdownContent = summaryElement.innerHTML.replace(/<button.*?<\/button>/g, '');
            }
            summaryEditors[sessionId] = CodeMirror.fromTextArea(textarea, {
              lineNumbers: true,
              theme: 'material-darker',
              mode: 'markdown',
              lineWrapping: true
            });
            summaryEditors[sessionId].setValue(markdownContent);
            summaryEditors[sessionId].refresh();
          } else {
            summaryEditors[sessionId].refresh();
          }
        });
      }
      if (newRegenerateBtn) {
        newRegenerateBtn.addEventListener('click', function() {
          // Removed confirmation dialog for immediate regeneration
          const summaryElement = document.getElementById(`summary-${sessionId}`);
          const statusElement = document.getElementById(`status-${sessionId}`);
          const spinnerElement = document.getElementById(`spinner-${sessionId}`);
          if (statusElement && spinnerElement) {
            statusElement.textContent = 'Regenerating summary...';
            statusElement.className = 'status-message thread-status text-info';
            statusElement.style.display = 'block';
            spinnerElement.style.display = 'inline-block';
            summaryElement.style.opacity = '0.5';
            fetch('/assignment/b774c6f556/regenerate_summary', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ session_id: sessionId })
            })
            .then(response => response.json())
            .then(data => {
              spinnerElement.style.display = 'none';
              if (data.success) {
                summaryElement.innerHTML = data.content;
                summaryElement.style.opacity = '1';
                statusElement.textContent = data.message;
                statusElement.className = 'status-message thread-status success';
                attachButtonListeners(sessionId);
                setTimeout(() => { statusElement.style.display = 'none'; }, 3000);
              } else {
                summaryElement.style.opacity = '1';
                statusElement.textContent = data.message || 'Error regenerating summary';
                statusElement.className = 'status-message thread-status error';
                setTimeout(() => { statusElement.style.display = 'none'; }, 5000);
              }
            })
            .catch(error => {
              spinnerElement.style.display = 'none';
              summaryElement.style.opacity = '1';
              statusElement.textContent = 'Error regenerating summary: ' + error;
              statusElement.className = 'status-message thread-status error';
              setTimeout(() => { statusElement.style.display = 'none'; }, 5000);
            });
          }
        });
      }
    }
    function showSummaryStatus(sessionId, message, type) {
      const statusEl = document.getElementById(`summary-editor-status-${sessionId}`);
      statusEl.textContent = message;
      statusEl.className = `status-message ${type}`;
      statusEl.style.display = 'block';
      if (type === 'success') {
        setTimeout(() => { statusEl.style.display = 'none'; }, 3000);
      }
    }
  });
</script>

<!-- =====================
     Export/Share Functionality
     ===================== -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Export button
    const exportBtn = document.querySelector('a[href*="/export"]');
    if (exportBtn) {
      exportBtn.addEventListener('click', function(e) {
        e.preventDefault();
        const currentTheme = localStorage.getItem('theme') === 'light' ? 'light-mode' : 'dark-mode';
        const exportUrl = new URL(this.href, window.location.origin);
        
        // Add selected histogram fields to export URL
        const selectedHistograms = getSelectedHistograms();
        if (selectedHistograms.length > 0) {
          exportUrl.searchParams.set('histograms', selectedHistograms.join(','));
        }
        
        exportUrl.searchParams.set('theme', currentTheme);
        window.location.href = exportUrl.toString();
      });
    }
    // Set theme class on HTML element for export mode
    if ('True' === 'True' && 'dark-mode') {
      document.documentElement.className = 'dark-mode';
    }
    // Share export button
    const shareExportBtn = document.getElementById('share-export-btn');
    if (shareExportBtn) {
      shareExportBtn.addEventListener('click', function(e) {
        e.preventDefault();
        shareExportBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
        shareExportBtn.disabled = true;
        const currentTheme = localStorage.getItem('theme') === 'light' ? 'light-mode' : 'dark-mode';
        
        // Add selected histogram fields to share request
        const selectedHistograms = getSelectedHistograms();
        
        fetch('/assignment/b774c6f556/share_export', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            theme: currentTheme,
            selected_histograms: selectedHistograms
          })
        })
        .then(response => response.json())
        .then(data => {
          shareExportBtn.innerHTML = '<i class="fas fa-share-alt"></i> Share';
          shareExportBtn.disabled = false;
          if (data.success) {
            const modalHtml = `
              <div class="modal fade" id="shareModal" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                  <div class="modal-content" style="background-color: var(--card-bg); color: var(--text-color);">
                    <div class="modal-header" style="border-color: var(--border-color);">
                      <h5 class="modal-title" id="shareModalLabel">Share Export</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: var(--text-color);">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <p>Your export has been saved. Share this link:</p>
                      <div class="input-group mb-3">
                        <input type="text" id="share-link" class="form-control" value="${data.share_url}" readonly style="background-color: var(--input-bg); color: var(--text-color); border-color: var(--border-color);">
                        <div class="input-group-append">
                          <button class="btn btn-primary" type="button" id="copy-link-btn">
                            <i class="fas fa-copy"></i> Copy
                          </button>
                        </div>
                      </div>
                      <div id="copy-feedback" class="text-success" style="display: none;">Link copied to clipboard!</div>
                    </div>
                    <div class="modal-footer" style="border-color: var(--border-color);">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                      <a href="${data.share_url}" target="_blank" class="btn btn-primary">
                        <i class="fas fa-external-link-alt"></i> Open
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            `;
            const modalContainer = document.createElement('div');
            modalContainer.innerHTML = modalHtml;
            document.body.appendChild(modalContainer);
            $('#shareModal').modal('show');
            document.getElementById('copy-link-btn').addEventListener('click', function() {
              const shareLink = document.getElementById('share-link');
              shareLink.select();
              document.execCommand('copy');
              const copyFeedback = document.getElementById('copy-feedback');
              copyFeedback.style.display = 'block';
              setTimeout(() => { copyFeedback.style.display = 'none'; }, 3000);
            });
            $('#shareModal').on('hidden.bs.modal', function() {
              modalContainer.remove();
            });
          } else {
            alert('Error: ' + (data.message || 'Could not generate shared export'));
          }
        })
        .catch(error => {
          shareExportBtn.innerHTML = '<i class="fas fa-share-alt"></i> Share';
          shareExportBtn.disabled = false;
          alert('Error: Could not generate shared export');
          console.error('Error:', error);
        });
      });
    }
    
    // Helper function to get selected histograms
    function getSelectedHistograms() {
      const checkboxes = document.querySelectorAll('.export-histogram-checkbox:checked');
      return Array.from(checkboxes).map(cb => cb.getAttribute('data-field')).filter(Boolean);
    }
  });
</script>

<!-- =====================
     Histogram Selection for Export
     ===================== -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Handle the select/deselect all buttons
    const selectAllBtn = document.getElementById('select-all-histograms');
    const deselectAllBtn = document.getElementById('deselect-all-histograms');
    
    if (selectAllBtn) {
      selectAllBtn.addEventListener('click', function() {
        document.querySelectorAll('.export-histogram-checkbox').forEach(checkbox => {
          checkbox.checked = true;
          // Add a small animation to show the change
          const label = checkbox.nextElementSibling;
          if (label) {
            label.style.transition = 'color 0.3s ease';
            label.style.color = '#8a8aff';
            setTimeout(() => {
              label.style.color = '';
            }, 500);
          }
        });
        // Show visual feedback
        const originalText = selectAllBtn.innerHTML;
        selectAllBtn.innerHTML = '<i class="fas fa-check mr-1"></i> All Selected';
        setTimeout(() => {
          selectAllBtn.innerHTML = originalText;
        }, 1000);
        // Save selections to localStorage
        saveHistogramSelections();
      });
    }
    
    if (deselectAllBtn) {
      deselectAllBtn.addEventListener('click', function() {
        document.querySelectorAll('.export-histogram-checkbox').forEach(checkbox => {
          checkbox.checked = false;
          // Add a small animation to show the change
          const label = checkbox.nextElementSibling;
          if (label) {
            label.style.transition = 'color 0.3s ease';
            label.style.opacity = '0.7';
            setTimeout(() => {
              label.style.opacity = '';
            }, 500);
          }
        });
        // Show visual feedback
        const originalText = deselectAllBtn.innerHTML;
        deselectAllBtn.innerHTML = '<i class="fas fa-times mr-1"></i> All Deselected';
        setTimeout(() => {
          deselectAllBtn.innerHTML = originalText;
        }, 1000);
        // Save selections to localStorage
        saveHistogramSelections();
      });
    }
    
    // Initialize checkboxes from localStorage if available
    const savedSelections = localStorage.getItem('selected_histograms');
    if (savedSelections) {
      try {
        const selections = JSON.parse(savedSelections);
        document.querySelectorAll('.export-histogram-checkbox').forEach(checkbox => {
          const field = checkbox.getAttribute('data-field');
          if (field && selections.includes(field)) {
            checkbox.checked = true;
          }
        });
      } catch (e) {
        console.error('Error loading saved histogram selections:', e);
      }
    } else {
      // If no saved selections, select all by default
      document.querySelectorAll('.export-histogram-checkbox').forEach(checkbox => {
        checkbox.checked = true;
      });
      saveHistogramSelections();
    }
    
    // Save selections to localStorage when changed
    document.querySelectorAll('.export-histogram-checkbox').forEach(checkbox => {
      checkbox.addEventListener('change', saveHistogramSelections);
    });
    
    function saveHistogramSelections() {
      const selectedFields = Array.from(document.querySelectorAll('.export-histogram-checkbox:checked'))
        .map(cb => cb.getAttribute('data-field'))
        .filter(Boolean);
      
      localStorage.setItem('selected_histograms', JSON.stringify(selectedFields));
    }
  });
</script>

<!-- =====================
     Social Sharing Buttons
     ===================== -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('twitter-share')) {
      const pageUrl = encodeURIComponent(window.location.href);
      const shareMessage = encodeURIComponent("Check out the assignments my students just finished on Sway! The AI Guide killed it! 🤯");
      
      // X (formerly Twitter) sharing
      const xBtn = document.getElementById('twitter-share');
      xBtn.href = `https://x.com/intent/tweet?text=${shareMessage}&url=${pageUrl}`;
      xBtn.target = '_blank';
      xBtn.rel = 'noopener noreferrer';
      
      // Facebook sharing
      const facebookBtn = document.getElementById('facebook-share');
      facebookBtn.href = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}&quote=${shareMessage}`;
      facebookBtn.target = '_blank';
      facebookBtn.rel = 'noopener noreferrer';
      
      // LinkedIn sharing
      const linkedinBtn = document.getElementById('linkedin-share');
      linkedinBtn.href = `https://www.linkedin.com/sharing/share-offsite/?url=${pageUrl}`;
      linkedinBtn.target = '_blank';
      linkedinBtn.rel = 'noopener noreferrer';
      
      // Instagram sharing (requires copy to clipboard)
      const instagramBtn = document.getElementById('instagram-share');
      instagramBtn.addEventListener('click', function(e) {
        e.preventDefault();
        const textarea = document.createElement('textarea');
        textarea.value = `${shareMessage}\n\n${window.location.href}`;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('Link and message copied to clipboard. Paste this into Instagram to share!');
      });
    }
  });
</script>

<!-- =====================
     CSS for Status Messages and CodeMirror
     ===================== -->
<style>
  .status-message {
    margin-top: 15px;
    padding: 10px;
    border-radius: 6px;
  }
  .success {
    background-color: rgba(40, 167, 69, 0.2);
    border: 1px solid #28a745;
    color: #28a745;
  }
  .error {
    background-color: rgba(220, 53, 69, 0.2);
    border: 1px solid #dc3545;
    color: #dc3545;
  }
  .CodeMirror {
    height: auto;
    min-height: 300px;
    border-radius: 6px;
    font-family: 'Fira Code', 'Courier New', monospace;
    font-size: 14px;
    padding: 10px 0;
    margin-bottom: 20px;
  }
</style>
  <script src="/static/js/histogram-title-fixer.js"></script>
  
  <!-- Script for polished Show More/Fewer functionality in all modes -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Instructor Report Show More
      const setupReportShowMore = function() {
        const reportContent = document.getElementById('report-content');
        if (reportContent) {
          const headings = reportContent.querySelectorAll('h3');
          if (headings.length > 2) {
            const secondHeading = headings[1];
            const hiddenContentWrapper = document.createElement('div');
            hiddenContentWrapper.id = 'hidden-report-content';
            hiddenContentWrapper.className = 'collapsible-section collapsed';
            let currentNode = secondHeading.nextElementSibling;
            let nodesToMove = [];
            while (currentNode) {
              if (currentNode.tagName === 'H3' && currentNode !== secondHeading) {
                nodesToMove.push(currentNode);
              } else if (nodesToMove.length > 0) {
                nodesToMove.push(currentNode);
              }
              currentNode = currentNode.nextElementSibling;
            }
            nodesToMove.forEach(node => { hiddenContentWrapper.appendChild(node); });
            reportContent.appendChild(hiddenContentWrapper);
            
            const showMoreBtn = document.createElement('button');
            showMoreBtn.className = 'btn btn-thread-toggle show-toggle-btn';
            showMoreBtn.innerHTML = 'Continue Reading <i class="fas fa-chevron-down"></i>';
            showMoreBtn.style.marginTop = '1.5rem';
            reportContent.insertBefore(showMoreBtn, hiddenContentWrapper);
            
            // Add a spacer div ABOVE the Continue Reading button for extra spacing
            const spacerDiv = document.createElement('div');
            spacerDiv.style.height = '1rem';
            spacerDiv.style.clear = 'both';
            reportContent.insertBefore(spacerDiv, showMoreBtn);
            
            showMoreBtn.addEventListener('click', function() {
              const expanded = hiddenContentWrapper.classList.contains('collapsed');
              if (expanded) {
                hiddenContentWrapper.classList.remove('collapsed');
                showMoreBtn.classList.add('expanded');
                showMoreBtn.innerHTML = 'Show Less <i class="fas fa-chevron-up"></i>';
              } else {
                hiddenContentWrapper.classList.add('collapsed');
                showMoreBtn.classList.remove('expanded');
                showMoreBtn.innerHTML = 'Continue Reading <i class="fas fa-chevron-down"></i>';
              }
            });
          }
        }
      };
      // Threads Masonry Show More
      const setupThreadsShowMore = function() {
        const masonryGrid = document.querySelector('.masonry-grid');
        if (!masonryGrid || masonryGrid.children.length <= 2) {
          return; // Do nothing if 2 or fewer items
        }

        const masonryItems = Array.from(masonryGrid.querySelectorAll('.masonry-item'));
        const itemsToShowInitially = 2;

        const performHideAndSetupButtons = () => {
          // Hide items beyond the initial set
          for (let i = itemsToShowInitially; i < masonryItems.length; i++) {
            if (masonryItems[i]) { // Ensure item exists
              masonryItems[i].classList.add('hidden-thread');
            }
          }

          const hiddenItemCount = masonryGrid.querySelectorAll('.masonry-item.hidden-thread').length;
          if (hiddenItemCount === 0 && masonryItems.length > itemsToShowInitially) {
            // Fallback or logging if hiding didn't work as expected but should have
            console.warn("Masonry items were expected to be hidden but were not.");
            // Potentially, if itemsToShowInitially is high, this might be normal if total items < itemsToShowInitially
          }
          
          // Only proceed with buttons if there are actually items to unhide
          if (masonryItems.length <= itemsToShowInitially) {
            return;
          }

          const showMoreThreadsBtn = document.createElement('button');
          showMoreThreadsBtn.className = 'btn btn-thread-toggle show-toggle-btn';

          const updateShowMoreText = () => {
            const currentHiddenCount = masonryGrid.querySelectorAll('.masonry-item.hidden-thread').length;
            showMoreThreadsBtn.innerHTML = `Show ${currentHiddenCount} More Threads`;
            // Show button only if there are hidden threads
            showMoreThreadsBtn.style.display = currentHiddenCount > 0 ? 'block' : 'none';
          };
          
          const showFewerThreadsBtn = document.createElement('button');
          showFewerThreadsBtn.className = 'btn btn-thread-toggle show-toggle-btn';
          showFewerThreadsBtn.innerHTML = 'Show Fewer Threads';
          showFewerThreadsBtn.style.display = 'none'; // Initially hidden

          const threadListSection = document.querySelector('.thread-list');
          let spacerDiv;
          if (threadListSection) {
            spacerDiv = document.createElement('div');
            spacerDiv.style.height = '4px';
            spacerDiv.style.clear = 'both';
            spacerDiv.style.display = 'none';
            threadListSection.appendChild(spacerDiv);
            threadListSection.appendChild(showFewerThreadsBtn);
          }
          
          // Insert Show More button only if there's a chance it will be displayed
          if (masonryItems.length > itemsToShowInitially) {
             masonryGrid.parentNode.insertBefore(showMoreThreadsBtn, masonryGrid.nextSibling);
             updateShowMoreText(); // Set initial text and visibility
          }


          showMoreThreadsBtn.addEventListener('click', function() {
            masonryItems.forEach(item => item.classList.remove('hidden-thread'));
            updateShowMoreText(); // Button should hide itself
            showFewerThreadsBtn.style.display = 'block';
            if (spacerDiv) spacerDiv.style.display = 'block';
          });

          showFewerThreadsBtn.addEventListener('click', function() {
            for (let i = itemsToShowInitially; i < masonryItems.length; i++) {
              if (masonryItems[i]) {
                masonryItems[i].classList.add('hidden-thread');
              }
            }
            updateShowMoreText(); // Button should reappear and update count
            showFewerThreadsBtn.style.display = 'none';
            if (spacerDiv) spacerDiv.style.display = 'none';
            
            const chatThreadsSectionTitle = document.querySelector('h5.section-title .fa-comments');
            if (chatThreadsSectionTitle && chatThreadsSectionTitle.closest('h5.section-title')) {
              chatThreadsSectionTitle.closest('h5.section-title').scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
              masonryGrid.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          });
        };

        if (window.requestAnimationFrame) {
          window.requestAnimationFrame(() => {
            setTimeout(performHideAndSetupButtons, 75); // Delay to allow layout to settle
          });
        } else {
          setTimeout(performHideAndSetupButtons, 75); // Fallback
        }
      };

      setupReportShowMore();
      setupThreadsShowMore();

      // Opinion Distribution Show More/Less
      const histogramCards = document.querySelectorAll('.opinion-histogram-card');
      const showMoreBtn = document.getElementById('show-more-histograms-btn');
      const showFewerBtn = document.getElementById('show-fewer-histograms-btn');
      const maxVisible = 6;
      if (histogramCards.length > maxVisible) {
        for (let i = maxVisible; i < histogramCards.length; i++) {
          histogramCards[i].classList.add('hidden-histogram');
        }
        showMoreBtn.style.display = 'inline-block';
      }
      if (showMoreBtn && showFewerBtn) {
        showMoreBtn.addEventListener('click', function() {
          for (let i = maxVisible; i < histogramCards.length; i++) {
            histogramCards[i].classList.remove('hidden-histogram');
          }
          showMoreBtn.style.display = 'none';
          showFewerBtn.style.display = 'inline-block';
        });
        showFewerBtn.addEventListener('click', function() {
          for (let i = maxVisible; i < histogramCards.length; i++) {
            histogramCards[i].classList.add('hidden-histogram');
          }
          showMoreBtn.style.display = 'inline-block';
          showFewerBtn.style.display = 'none';
          // Scroll to the top of the histogram section
          const sectionTitle = document.querySelector('.section-title .fa-chart-bar');
          if (sectionTitle && sectionTitle.closest('.section-title')) {
            sectionTitle.closest('.section-title').scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      }
    });
  </script>
  
  <!-- Script to disable hover animations -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Create a style element
      var style = document.createElement('style');
      
      // Add CSS rules to disable hover animations
      style.innerHTML = `
        .card:hover, 
        .thread-item:hover, 
        .histogram-container:hover, 
        .histogram-bar:hover, 
        .histogram-card:hover {
          transform: none !important;
        }
      `;
      
      // Append the style element to the head
      document.head.appendChild(style);
    });
  </script>
  </div> <!-- Close content-wrapper -->
</body>
</html>